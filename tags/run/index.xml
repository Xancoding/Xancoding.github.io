<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Run on Xan&#39;s Blog</title>
    <link>https://xancoding.github.io/tags/run/</link>
    <description>Recent content in Run on Xan&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Tue, 11 Oct 2022 19:43:26 +0800</lastBuildDate><atom:link href="https://xancoding.github.io/tags/run/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>RUN</title>
      <link>https://xancoding.github.io/posts/run/</link>
      <pubDate>Tue, 11 Oct 2022 19:43:26 +0800</pubDate>
      
      <guid>https://xancoding.github.io/posts/run/</guid>
      <description>&lt;p&gt;[[Redis]]&lt;/p&gt;
&lt;h1 id=&#34;django&#34;&gt;Django&lt;/h1&gt;
&lt;h2 id=&#34;用户名密码登录&#34;&gt;用户名密码登录&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/video/3550/&#34;&gt;6.1用户名密码登录-Vedio&lt;/a&gt;
数据表定义：11m02s~21m02s
views &amp;amp; urls &amp;amp; js：25m01s~32m50s~33m37s~47m30s
将头像渲染到角色上：48m~50m20s
登陆界面 HTML+CSS：57m10s~1h42m30s~1h49m56s
登陆界面 逻辑实现：1h50m~1h53m47s~1h58m41s~2h20s~2h32m40s
&lt;a href=&#34;https://www.acwing.com/solution/content/79314/&#34;&gt;6.1 上课笔记&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/solution/content/75831/&#34;&gt;6.1 上课笔记——&lt;strong&gt;客户端请求与Django响应流程&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;我们在定义完一个数据表之后，需要将其&lt;strong&gt;更新到数据库&lt;/strong&gt;，这时候我们需要执行两句话：&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
python3 manage.py makemigrations
python3 manage.py migrate
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;客户端请求与Django响应流程&lt;/strong&gt;
用户在客户端通过&lt;code&gt;$.ajax&lt;/code&gt;发送请求，根据&lt;code&gt;urls&lt;/code&gt;路由到对应的&lt;code&gt;views&lt;/code&gt;中的函数，处理&lt;code&gt;request&lt;/code&gt;后返回&lt;code&gt;JsonResponse&lt;/code&gt; 至客户端&lt;/p&gt;
&lt;p&gt;&lt;code&gt;views&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-py&#34; data-lang=&#34;py&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;from&lt;/span&gt; django.http &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; JsonResponse
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;from&lt;/span&gt; django.contrib.auth &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; authenticate, login
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;def&lt;/span&gt; signin(request):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    data = request.GET &lt;span style=&#34;color:#007f7f&#34;&gt;# 获取请求的信息&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    username = data.get(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#007f7f&#34;&gt;# 用户名&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    password = data.get(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#007f7f&#34;&gt;# 密码&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    user = authenticate(username = username, password = password) &lt;span style=&#34;color:#007f7f&#34;&gt;# 从数据库中查找这个用户&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; not user: &lt;span style=&#34;color:#007f7f&#34;&gt;# 如果没有就直接返回不成功&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; JsonResponse({
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;result&amp;#39;&lt;/span&gt;: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;用户名或密码不正确&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        })
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   login(request, user) &lt;span style=&#34;color:#007f7f&#34;&gt;# 找到了就登录&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;urls&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-py&#34; data-lang=&#34;py&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;from&lt;/span&gt; game.views.settings.login &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; signin &lt;span style=&#34;color:#007f7f&#34;&gt;# 引入自己写的逻辑&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;urlpatterns = [
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    path(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;login/&amp;#34;&lt;/span&gt;, signin, name = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;settings_login&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#007f7f&#34;&gt;# &amp;#34;settings/login/&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;js&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;login_on_remote() &lt;span style=&#34;color:#007f7f&#34;&gt;// 在远程服务器上登录
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; outer = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;this&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; username = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;this&lt;/span&gt;.$login_username.val(); &lt;span style=&#34;color:#007f7f&#34;&gt;// 获取输入框中的用户名
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; password = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;this&lt;/span&gt;.$login_password.val(); &lt;span style=&#34;color:#007f7f&#34;&gt;// 获取输入框中的密码
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;this&lt;/span&gt;.$login_error_message.empty(); &lt;span style=&#34;color:#007f7f&#34;&gt;// 清楚错误信息
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    $.ajax({
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        url: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;登录URL&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#007f7f&#34;&gt;// 访问url
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;        type: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;GET&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        data: {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            username: username, &lt;span style=&#34;color:#007f7f&#34;&gt;// 传输数据
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;            password: password,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        success: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt;(resp){
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            console.log(resp); &lt;span style=&#34;color:#007f7f&#34;&gt;// 测试输出
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (resp.result === &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                location.reload(); &lt;span style=&#34;color:#007f7f&#34;&gt;// 如果成功就刷新
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                outer.$login_error_message.html(resp.result); &lt;span style=&#34;color:#007f7f&#34;&gt;// 如果失败就显示错误信息
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    });
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;第三方登录&#34;&gt;第三方登录&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/video/3565/&#34;&gt;6.2 web端AcWing一键登录-Vedio&lt;/a&gt;
在&lt;code&gt;django&lt;/code&gt;中集成数据库&lt;code&gt;redis&lt;/code&gt;：7m10s~13m20s
&lt;code&gt;redis&lt;/code&gt;命令：13m40s~16m34s
&lt;strong&gt;Oauth2一键授权登录的基本原理&lt;/strong&gt;：17m30s~29m15s~32m51s
数据表添加&lt;code&gt;openid&lt;/code&gt;信息：33m20s~34m47s
&lt;strong&gt;Oauth2一键授权登录的代码实现&lt;/strong&gt;：35m20s~1h25s~1h27m20s
用户点击&lt;code&gt;AcWing一键登录&lt;/code&gt;，通过&lt;code&gt;urls &amp;amp; views&lt;/code&gt;调用&lt;code&gt;apply_code&lt;/code&gt;函数，将&lt;code&gt;state&lt;/code&gt;放到&lt;code&gt;redis&lt;/code&gt;中，将&lt;code&gt;appid &amp;amp; redirect_uri &amp;amp; scope &amp;amp; state&lt;/code&gt; 传入&lt;code&gt;apply_code_url&lt;/code&gt;链接，返回并重定向至&lt;code&gt;apply_code_url&lt;/code&gt;向用户询问是否授权
用户点击&lt;code&gt;同意&lt;/code&gt;后，重定向至&lt;code&gt;redirect_uri&lt;/code&gt;链接，返回参数为&lt;code&gt;code&lt;/code&gt;和&lt;code&gt;state&lt;/code&gt;，通过&lt;code&gt;urls &amp;amp; views&lt;/code&gt;调用&lt;code&gt;receive_code&lt;/code&gt;函数。若验证&lt;code&gt;state&lt;/code&gt;失败，直接重定向至初始界面
若验证&lt;code&gt;state&lt;/code&gt;成功，将&lt;code&gt;appid &amp;amp; code &amp;amp; secret&lt;/code&gt;发送至&lt;code&gt;AcWing服务器&lt;/code&gt;，申请授权令牌&lt;code&gt;access_token&lt;/code&gt;和用户的&lt;code&gt;openid&lt;/code&gt;
若申请令牌成功，将&lt;code&gt;access_token &amp;amp; openid&lt;/code&gt;发送至&lt;code&gt;AcWing服务器&lt;/code&gt;，得到用户信息，创建并登录用户，最后重定向至初始界面
&lt;a href=&#34;https://www.acwing.com/blog/content/12466/&#34;&gt;6.2 &lt;strong&gt;Web端AcWing一键登录-讲义&lt;/strong&gt;&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/solution/content/79354/&#34;&gt;6.2 &lt;strong&gt;上课笔记&lt;/strong&gt;&lt;/a&gt;
&lt;code&gt;redirect_uri = quote(&amp;quot;https://app23.acapp.acwing.com.cn/settings/acwing/web/receive_code&amp;quot;)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/video/3566/&#34;&gt;6.3 acapp端AcWing一键登录-Vedio&lt;/a&gt;
&lt;strong&gt;Oauth2一键授权登录的基本原理&lt;/strong&gt;：10m~12m20s~16m35s~18m
&lt;strong&gt;Oauth2一键授权登录的代码实现&lt;/strong&gt;：19m25s~21m~23m25s~34m29s~42m10s
&lt;a href=&#34;https://www.acwing.com/blog/content/12467/&#34;&gt;6.3 acapp端AcWing一键登录-讲义&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/solution/content/79365/&#34;&gt;6.3 上课笔记&lt;/a&gt;&lt;/p&gt;
</description>
      <content:encoded><![CDATA[<p>[[Redis]]</p>
<h1 id="django">Django</h1>
<h2 id="用户名密码登录">用户名密码登录</h2>
<p><a href="https://www.acwing.com/video/3550/">6.1用户名密码登录-Vedio</a>
数据表定义：11m02s~21m02s
views &amp; urls &amp; js：25m01s~32m50s~33m37s~47m30s
将头像渲染到角色上：48m~50m20s
登陆界面 HTML+CSS：57m10s~1h42m30s~1h49m56s
登陆界面 逻辑实现：1h50m~1h53m47s~1h58m41s~2h20s~2h32m40s
<a href="https://www.acwing.com/solution/content/79314/">6.1 上课笔记</a>
<a href="https://www.acwing.com/solution/content/75831/">6.1 上课笔记——<strong>客户端请求与Django响应流程</strong></a></p>
<ul>
<li>我们在定义完一个数据表之后，需要将其<strong>更新到数据库</strong>，这时候我们需要执行两句话：</li>
</ul>
<pre tabindex="0"><code>
python3 manage.py makemigrations
python3 manage.py migrate
</code></pre><p><strong>客户端请求与Django响应流程</strong>
用户在客户端通过<code>$.ajax</code>发送请求，根据<code>urls</code>路由到对应的<code>views</code>中的函数，处理<code>request</code>后返回<code>JsonResponse</code> 至客户端</p>
<p><code>views</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> django.http <span style="color:#fff;font-weight:bold">import</span> JsonResponse
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> django.contrib.auth <span style="color:#fff;font-weight:bold">import</span> authenticate, login
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> signin(request):
</span></span><span style="display:flex;"><span>    data = request.GET <span style="color:#007f7f"># 获取请求的信息</span>
</span></span><span style="display:flex;"><span>    username = data.get(<span style="color:#0ff;font-weight:bold">&#39;username&#39;</span>) <span style="color:#007f7f"># 用户名</span>
</span></span><span style="display:flex;"><span>    password = data.get(<span style="color:#0ff;font-weight:bold">&#39;password&#39;</span>) <span style="color:#007f7f"># 密码</span>
</span></span><span style="display:flex;"><span>    user = authenticate(username = username, password = password) <span style="color:#007f7f"># 从数据库中查找这个用户</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> not user: <span style="color:#007f7f"># 如果没有就直接返回不成功</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> JsonResponse({
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">&#39;result&#39;</span>: <span style="color:#0ff;font-weight:bold">&#34;用户名或密码不正确&#34;</span>
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>   login(request, user) <span style="color:#007f7f"># 找到了就登录</span>
</span></span></code></pre></div><p><code>urls</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> game.views.settings.login <span style="color:#fff;font-weight:bold">import</span> signin <span style="color:#007f7f"># 引入自己写的逻辑</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>urlpatterns = [
</span></span><span style="display:flex;"><span>    path(<span style="color:#0ff;font-weight:bold">&#34;login/&#34;</span>, signin, name = <span style="color:#0ff;font-weight:bold">&#34;settings_login&#34;</span>), <span style="color:#007f7f"># &#34;settings/login/&#34;</span>
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p><code>js</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>login_on_remote() <span style="color:#007f7f">// 在远程服务器上登录
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">let</span> outer = <span style="color:#fff;font-weight:bold">this</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">let</span> username = <span style="color:#fff;font-weight:bold">this</span>.$login_username.val(); <span style="color:#007f7f">// 获取输入框中的用户名
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">let</span> password = <span style="color:#fff;font-weight:bold">this</span>.$login_password.val(); <span style="color:#007f7f">// 获取输入框中的密码
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">this</span>.$login_error_message.empty(); <span style="color:#007f7f">// 清楚错误信息
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>    $.ajax({
</span></span><span style="display:flex;"><span>        url: <span style="color:#0ff;font-weight:bold">&#34;登录URL&#34;</span>, <span style="color:#007f7f">// 访问url
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        type: <span style="color:#0ff;font-weight:bold">&#34;GET&#34;</span>,
</span></span><span style="display:flex;"><span>        data: {
</span></span><span style="display:flex;"><span>            username: username, <span style="color:#007f7f">// 传输数据
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            password: password,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        success: <span style="color:#fff;font-weight:bold">function</span>(resp){
</span></span><span style="display:flex;"><span>            console.log(resp); <span style="color:#007f7f">// 测试输出
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (resp.result === <span style="color:#0ff;font-weight:bold">&#34;success&#34;</span>) {
</span></span><span style="display:flex;"><span>                location.reload(); <span style="color:#007f7f">// 如果成功就刷新
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>                outer.$login_error_message.html(resp.result); <span style="color:#007f7f">// 如果失败就显示错误信息
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="第三方登录">第三方登录</h2>
<p><a href="https://www.acwing.com/video/3565/">6.2 web端AcWing一键登录-Vedio</a>
在<code>django</code>中集成数据库<code>redis</code>：7m10s~13m20s
<code>redis</code>命令：13m40s~16m34s
<strong>Oauth2一键授权登录的基本原理</strong>：17m30s~29m15s~32m51s
数据表添加<code>openid</code>信息：33m20s~34m47s
<strong>Oauth2一键授权登录的代码实现</strong>：35m20s~1h25s~1h27m20s
用户点击<code>AcWing一键登录</code>，通过<code>urls &amp; views</code>调用<code>apply_code</code>函数，将<code>state</code>放到<code>redis</code>中，将<code>appid &amp; redirect_uri &amp; scope &amp; state</code> 传入<code>apply_code_url</code>链接，返回并重定向至<code>apply_code_url</code>向用户询问是否授权
用户点击<code>同意</code>后，重定向至<code>redirect_uri</code>链接，返回参数为<code>code</code>和<code>state</code>，通过<code>urls &amp; views</code>调用<code>receive_code</code>函数。若验证<code>state</code>失败，直接重定向至初始界面
若验证<code>state</code>成功，将<code>appid &amp; code &amp; secret</code>发送至<code>AcWing服务器</code>，申请授权令牌<code>access_token</code>和用户的<code>openid</code>
若申请令牌成功，将<code>access_token &amp; openid</code>发送至<code>AcWing服务器</code>，得到用户信息，创建并登录用户，最后重定向至初始界面
<a href="https://www.acwing.com/blog/content/12466/">6.2 <strong>Web端AcWing一键登录-讲义</strong></a>
<a href="https://www.acwing.com/solution/content/79354/">6.2 <strong>上课笔记</strong></a>
<code>redirect_uri = quote(&quot;https://app23.acapp.acwing.com.cn/settings/acwing/web/receive_code&quot;)</code></p>
<p><a href="https://www.acwing.com/video/3566/">6.3 acapp端AcWing一键登录-Vedio</a>
<strong>Oauth2一键授权登录的基本原理</strong>：10m~12m20s~16m35s~18m
<strong>Oauth2一键授权登录的代码实现</strong>：19m25s~21m~23m25s~34m29s~42m10s
<a href="https://www.acwing.com/blog/content/12467/">6.3 acapp端AcWing一键登录-讲义</a>
<a href="https://www.acwing.com/solution/content/79365/">6.3 上课笔记</a></p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
