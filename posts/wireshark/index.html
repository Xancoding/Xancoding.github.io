<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>计算机网络课程大作业 | Xan's Blog</title><meta name=keywords content="Tech,Wireshark,工具,新技能,计算机网络"><meta name=description content="要求 团队合作、合理分工、按组为单位进行 报告文字内容不可拷贝粘贴现有文献，应反映小组所做的工作，有分析，实践性的选题应有具体操作或者配置过程描"><meta name=author content="
作者:&nbsp;Xan"><link rel=canonical href=https://xancoding.cn/posts/wireshark/><link crossorigin=anonymous href=/assets/css/stylesheet.3aa01cbced85ddebdb26eab94916f476145cedd3e7231731a39f34d88d6f410a.css integrity="sha256-OqAcvO2F3evbJuq5SRb0dhRc7dPnIxcxo5802I1vQQo=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xancoding.cn/img/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://xancoding.cn/img/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://xancoding.cn/img/favicon.ico><link rel=apple-touch-icon href=https://xancoding.cn/img/favicon.ico><link rel=mask-icon href=https://xancoding.cn/img/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style><link rel=stylesheet href=//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="计算机网络课程大作业"><meta property="og:description" content="要求 团队合作、合理分工、按组为单位进行 报告文字内容不可拷贝粘贴现有文献，应反映小组所做的工作，有分析，实践性的选题应有具体操作或者配置过程描"><meta property="og:type" content="article"><meta property="og:url" content="https://xancoding.cn/posts/wireshark/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-12T11:38:21+08:00"><meta property="article:modified_time" content="2022-11-12T11:38:21+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="计算机网络课程大作业"><meta name=twitter:description content="要求 团队合作、合理分工、按组为单位进行 报告文字内容不可拷贝粘贴现有文献，应反映小组所做的工作，有分析，实践性的选题应有具体操作或者配置过程描"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://xancoding.cn/posts/"},{"@type":"ListItem","position":3,"name":"计算机网络课程大作业","item":"https://xancoding.cn/posts/wireshark/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"计算机网络课程大作业","name":"计算机网络课程大作业","description":"要求 团队合作、合理分工、按组为单位进行 报告文字内容不可拷贝粘贴现有文献，应反映小组所做的工作，有分析，实践性的选题应有具体操作或者配置过程描","keywords":["Tech","Wireshark","工具","新技能","计算机网络"],"articleBody":"要求 团队合作、合理分工、按组为单位进行 报告文字内容不可拷贝粘贴现有文献，应反映小组所做的工作，有分析，实践性的选题应有具体操作或者配置过程描述，辅以截图或实验数据 所交报告中应在最后注明组员分工、参考文献，报告字数3000-6000 不同班级的小组可选择相同的题目，但重复计数（由各班学委协调），不可多于3组，且报告内容不可相同，要求独立完成各组任务 除了个别综述性的选题，其它选题要求在实际平台上实践 选题 基于网络嗅探软件（wireshark）的协议分析实验\nWireshark的深入学习与掌握，如过滤器的使用，归纳方法 通过实验阐述ARP的工作原理 利用实验结果分析ICMP协议的报文结构字段定义 基于实验数据深入分析TCP协议的连接过程原理，报文的分片等功能 从校园网发起向外网中某Web服务器的访问，记录并分析从MAC层协议、IP协议、TCP协议一直到HTTP协议的过程 基于网络嗅探软件Wireshark的协议分析实验 Wireshark 是什么？ Wirkshark 是一个功能十分强大的开源的网络数据包分析器，能够在多种平台上抓取和分析网络包\nWirkshark 可被用于检查安全问题和解决网络问题，也可供开发者调试协议的实现和学习网络协议的原理\nWireshark使用 Npcap or WinPcap 作为接口，直接与网卡进行数据报文交换\nWireshark 下载与安装 官网地址：https://www.wireshark.org/，直接点击下一步下一步安装即可 但是，我在安装过程中报了如下的错误： 排查了好久，没找到合适的解决办法\n最后，下载 WinPcap 来代替 Npcap ，成功运行。\nWireshark 基本用法 简单抓包基础步骤：选择捕获接口 -\u003e 获取网络实时痕迹 -\u003e 获取报文 -\u003e 深入解析\n选择接口（网卡） 网络上传输的数据包需要经过网卡到达计算机，Wireshark可以捕获流经网卡的数据包\n在使用Wireshark捕获数据前，先要选择捕获接口。一台计算机可能会有不止一个网卡，此时需要选择你要捕获数据的接口。\n选择菜单栏上的 捕获-\u003e选项 选择想要捕获数据的接口后，点击开始 界面说明 开始捕获后，Wireshark会把捕获到的报文显示到界面上\n显示过滤器用于设置过滤条件进行数据列表区数据过滤 数据列表区展示的是Wireshark捕获到的所有数据包的列表，每个数据包包含 编号、时间戳、源地址、目标地址、协议、长度以及数据包信息 数据详细区展示的是在数据列表区中选中的数据包的分协议展示 Frame：物理层的数据帧概况 Ethernet II：数据链路层以太网帧头部信息 Internet Protocol Version 4： 互联网层IP包头部信息 Transmission Control Protocol：传输层的数据段头部信息，此处是TCP 数据字节区展示的是选中的数据包的源数据。另外，在数据详细区选中的某层或某字段，对应的数据会在数据字节区中高亮 过滤器设置 根据我们想要抓取的数据包，对过滤器进行设置。过滤掉冗余的数据包，找到我们需要的信息\n捕获过滤器 捕获过滤器表达式作用在Wireshark捕获数据包之前，只捕获符合条件的数据包\n当需要处理大量数据时，使用捕获过滤器可以节省大量资源\n界面说明 选择菜单栏上的 捕获-\u003e捕获过滤器 点击 + 即可添加新的过滤规则\nFilter Name 指代过滤器名称，用来给自己看该过滤器的过滤效果\nFilter Expression 指代过滤器表达式，需要使用 Berkeley Packet Filter 语法书写 语法规则 捕获过滤器使用 BPF 语法，表达式由多个原语组成：\n原语(primitives)：由名称或数字，以及描述它的多个限定词组成。 * 限定词(qualifiers) * Types：设置数字或者名称所指示类型，例如host www.baidu.com，如果没有指定此值，则默认使用“host”关键字 * host、post * net，设定子网， net 192.168.0.0 mask 255.255.255.0等价于net 192.168.0.0/24 * port，设置端口范围，例如port 6000-8000 * Dir：设置网络出入方向，例如dst port 80，如果没有特别指明来源或目的地，则默认使用“src or dst”作为关键字 * src、dst、src or dst、src and dst(src：源端口，dst：目标端口) * Proto：指定协议类型，例如udp，如果没有特别指明是什么协议，则默认使用所有支持的协议 * ether、fddi、tr、wlan、ip、ip6、arp、rarp、decnet、tcp、udp、icmp、igmp、icmp、igrp、pim、ah、esp、vrrp * 其他 * gateway：指明网关IP地址，等价于ether host 'ehost' and not host 'host' * broadcast：广播报文，例如ether broadcast或者ip broadcast * multicast：多播报文，例如ip multicast或者ip6 multicast * less、greater：小于或者大于 * 原语运算符 * 与：\u0026\u0026或者and * 或：||或者or * 非：!或者not 转载自：https://juejin.cn/post/6844904066229747720 应用示例 只抓取源端口或者目的端口范围6000到8000，并且是一个tcp协议或者ipv6的数据包\nsrc or dst port 6000-8000 \u0026\u0026 tcp or ip6 只抓取IP地址为192.168.0.10的数据包\nhost 192.168.0.10 显示过滤器 显示过滤器表达式作用在在Wireshark捕获数据包之后，从已捕获的所有数据包中显示出符合条件的数据包\n显示过滤表达式在工具栏下方的“应用显示过滤器”输入框输入即可生效 基本过滤表达式 一条基本的表达式由过滤项、过滤关系、过滤值三项组成 例如：ip.addr == 192.168.1.1，其中 ip.addr 为过滤项，== 为过滤关系，192.168.1.1 为过滤值。 该表达式的意思是 找出所有ip协议中源或目标ip等于192.168.1.1的数据包 过滤项 Wireshark的过滤项是 协议.协议字段 的模式，Wireshark支持的全部协议及协议字段可查看官方说明。 以端口为例，端口出现于tcp协议中。所以有端口这个过滤项且其写法就是tcp.port Wireshark出于缩减长度的原因，有些字段没有使用协议规定的名称而是使用简写，比如Destination Port在Wireshark中写为dstport Wireshark出于简便使用的原因，增加了一些协议中没有的字段，比如tcp协议只有源端口和目标端口字段，为了简便使用Wireshark增加了tcp.port来同时代表这两个字段 实际使用时我们输入协议.后Wireshark就会有支持的字段提示 过滤关系 过滤关系指的是大于、等于、小于等等式关系，具体可以看官方给出的表 过滤值 过滤值就是设定的过滤项应该满足过滤关系的标准，比如500、5000、50000等等。\n过滤值的写法一般已经被过滤项和过滤关系设定好了，只是填下自己的期望值就可以了。\n复合过滤表达式 所谓复合过滤表达示，就是指由多条基本过滤表达式组合而成的表达示。\n基本过滤表达式的写法还是不变的，复合过滤表达示多出来的东西就只是基本过滤表达示的“连接词”，我们依然直接参照官方给出的表 常见显示过滤需求及其对应表达式 数据链路层 筛选mac地址为04:f9:38:ad:13:26的数据包----eth.src == 04:f9:38:ad:13:26 筛选源mac地址为04:f9:38:ad:13:26的数据包----eth.src == 04:f9:38:ad:13:26 网络层 筛选ip地址为192.168.1.1的数据包----ip.addr == 192.168.1.1 筛选192.168.1.0网段的数据---- ip contains \"192.168.1\" 筛选192.168.1.1和192.168.1.2之间的数据包----ip.addr == 192.168.1.1 \u0026\u0026 ip.addr == 192.168.1.2 筛选从192.168.1.1到192.168.1.2的数据包----ip.src == 192.168.1.1 \u0026\u0026 ip.dst == 192.168.1.2 传输层 筛选tcp协议的数据包----tcp 筛选除tcp协议以外的数据包----!tcp 筛选端口为80的数据包----tcp.port == 80 筛选12345端口和80端口之间的数据包----tcp.port == 12345 \u0026\u0026 tcp.port == 80 筛选从12345端口到80端口的数据包----tcp.srcport == 12345 \u0026\u0026 tcp.dstport == 80 应用层 特别说明----http中http.request表示请求头中的第一行（如GET index.jsp HTTP/1.1），http.response表示响应头中的第一行（如HTTP/1.1 200 OK），其他头部都用http.header_name形式。 筛选url中包含.php的http数据包----http.request.uri contains \".php\" 筛选内容包含username的http数据包----http contains \"username\" 通过实验阐述ARP的工作原理 ARP即地址解析协议（Address Resolution Protocol），是根据IP地址获取MAC地址的一个TCP/IP协议\nARP用于解决同一个局域网上的主机或路由器的IP地址和MAC地址的映射问题\n每一台主机都设有一个 ARP高速缓存，里面存有 本局域网上 各主机和路由器的IP地址到MAC地址的映射表\nARP工作流程 当主机A要向本局域网上的某台主机B发送IP数据报时，就现在其ARP高速缓存中查找有无主机B的IP地址。若有，查出其对应的MAC地址，写入MAC帧；若没有，进行下述步骤 主机A的ARP进程在本局域网上广播一个ARP请求分组，其中有自己的IP地址到MAC地址的映射 本局域网上的所有主机运行的ARP进程都收到此ARP请求分组 主机B的IP地址与ARP请求分组中要查询的IP地址一致，就收下这个ARP请求分组，将主机A的MAC映射写入自己的ARP高速缓存，并向主机A发送ARP响应分组，同时在这个ARP响应分组中写入自己的MAC地址。由于其余所有主机的IP地址都与ARP请求分组中要查询的IP地址不一致，因此不理睬 主机A收到主机B的ARP响应分组后，就在其ARP高速缓存中写入主机B的IP地址到MAC地址的映射 实验步骤及内容 主机A\nIP地址：192.168.31.248\nMAC地址：c0:3c:59:5e:37:47\n主机B\nIP地址：192.168.31.186\nMAC地址：28:7f:cf:12:af:89\nARP命令练习 在cmd中使用ipconfig/all命令，查看自己的IP地址和MAC地址，同时让小组成员连接同一个WIFI执行相同的操作并记录 我的 IP地址和MAC地址 小组成员的 IP地址和MAC地址 使用arp -a查看ARP缓存表 使用ping小组成员的IP添加动态ARP表项 我在ping小组成员ip地址时碰到请求超时的问题。\n经排查，是因为windows防火墙默认设置的是不让别人ping通，通过修改防火墙相关设置解决了该问题。\n步骤：控制面板 → 系统和安全 → Windows防火墙 → 高级设置 → 入站规则 → 文件和打印机共享（回显请求 - ICMPv4-In）设置为启用 使用arp -a查看ARP缓存表，发生新增一条数据 以管理员身份运行cmd，执行arp -d *，删除缓存信息 抓包分析ARP协议 当ARP缓存对应数据为空时 实验步骤 主机A执行arp -d *，删除缓存信息 主机A运行Wireshark，设置显示过滤器表达式为arp.dst.proto_ipv4 == 192.168.31.186 and arp.src.proto_ipv4 == 192.168.31.248 or icmp 主机Aping主机B的ip地址 结果分析 主机A将自己的ip地址 192.168.31.248 \u0026 MAC地址 c0:3c:59:5e:37:47写入请求分组，并将目的ip地址设置为192.168.31.186，目的MAC地址设置为00:00:00:00:00:00，对本局域网内的所有主机进行广播 主机A发出的ARP请求分组 主机B收下这个ARP请求分组，将主机A的MAC映射写入自己的ARP高速缓存，并向主机A发送ARP响应分组，同时在这个ARP响应分组中写入自己的MAC地址，即28:7f:cf:12:af:89 主机A收到主机B的ARP响应分组后，就在其ARP高速缓存中写入主机B的IP地址到MAC地址的映射 主机A收到的来自主机B的ARP响应分组 主机A的ARP高速缓存表 当ARP缓存对应数据不为空时 实验步骤 主机A运行Wireshark，设置显示过滤器表达式为arp.dst.proto_ipv4 == 192.168.31.186 and arp.src.proto_ipv4 == 192.168.31.248 or icmp 主机B运行Wireshark，设置显示过滤器表达式为arp.dst.proto_ipv4 == 192.168.31.248 and arp.src.proto_ipv4 == 192.168.31.186 or icmp 主机A ping主机B的ip地址 结果分析 主机A没有发出ARP请求，而主机B接受到了主机A的ICMP报文，说明主机A直接使用了高速缓存区内的对应数据\n主机A发出的报文 主机B接受到的来自主机A的报文 利用实验结果分析ICMP协议的报文结构字段定义 ICMP即互联网控制报文协议（Internet Control Message Protocol），网络设备（包括路由器）使用它来发送错误消息和指示与另一个IP 地址通信时成功或失败的操作信息\nICMP询问报文 实验步骤 参考 Wireshark系列之4 捕获过滤器 网络——Wireshark工具 WireShark的基本用法 Wireshark使用教程（界面说明、捕获过滤器表达式、显示过滤器表达式） 一文精讲Wireshark的抓包和分析 Wireshark简明教程，新手专用，挑实在的讲，不搞花里胡哨 WireShark网络封包抓包工具各个界面介绍 实验3.利用Wireshark分析ARP协议 Wireshark官方文档 ","wordCount":"5221","inLanguage":"en","datePublished":"2022-11-12T11:38:21+08:00","dateModified":"2022-11-12T11:38:21+08:00","author":[{"@type":"Person","name":"Xan"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://xancoding.cn/posts/wireshark/"},"publisher":{"@type":"Organization","name":"Xan's Blog","logo":{"@type":"ImageObject","url":"https://xancoding.cn/img/favicon.ico"}}}</script><script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xancoding.cn accesskey=h title="Xan's Blog (Alt + H)"><img src=https://xancoding.cn/img/Headshot.jpg alt aria-label=logo height=35>Xan's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://xancoding.cn/ title=Home><span>Home</span></a></li><li><a href=https://xancoding.cn/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://xancoding.cn/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://xancoding.cn/links/ title=Links><span>Links</span></a></li><li><a href=https://xancoding.cn/about/ title=About><span>About</span></a></li><li><a href=https://xancoding.cn/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://xancoding.cn>Home</a>&nbsp;»&nbsp;<a href=https://xancoding.cn/posts/>Posts</a></div><h1 class=post-title>计算机网络课程大作业</h1><div class=post-meta>&nbsp;<span title='2022-11-12 11:38:21 +0800 CST'>2022-11-12</span>&nbsp;|&nbsp;<a href=https://github.com/Xancoding/Blog/tree/main/content/posts/wireshark.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e8%a6%81%e6%b1%82 aria-label=要求>要求</a></li><li><a href=#%e9%80%89%e9%a2%98 aria-label=选题>选题</a></li><li><a href=#%e5%9f%ba%e4%ba%8e%e7%bd%91%e7%bb%9c%e5%97%85%e6%8e%a2%e8%bd%af%e4%bb%b6wireshark%e7%9a%84%e5%8d%8f%e8%ae%ae%e5%88%86%e6%9e%90%e5%ae%9e%e9%aa%8c aria-label=基于网络嗅探软件Wireshark的协议分析实验>基于网络嗅探软件Wireshark的协议分析实验</a><ul><li><a href=#wireshark-%e6%98%af%e4%bb%80%e4%b9%88 aria-label="Wireshark 是什么？">Wireshark 是什么？</a></li><li><a href=#wireshark-%e4%b8%8b%e8%bd%bd%e4%b8%8e%e5%ae%89%e8%a3%85 aria-label="Wireshark 下载与安装">Wireshark 下载与安装</a></li><li><a href=#wireshark-%e5%9f%ba%e6%9c%ac%e7%94%a8%e6%b3%95 aria-label="Wireshark 基本用法">Wireshark 基本用法</a><ul><li><a href=#%e9%80%89%e6%8b%a9%e6%8e%a5%e5%8f%a3%e7%bd%91%e5%8d%a1 aria-label=选择接口（网卡）>选择接口（网卡）</a></li><li><a href=#%e7%95%8c%e9%9d%a2%e8%af%b4%e6%98%8e aria-label=界面说明>界面说明</a></li><li><a href=#%e8%bf%87%e6%bb%a4%e5%99%a8%e8%ae%be%e7%bd%ae aria-label=过滤器设置>过滤器设置</a><ul><li><a href=#%e6%8d%95%e8%8e%b7%e8%bf%87%e6%bb%a4%e5%99%a8 aria-label=捕获过滤器>捕获过滤器</a><ul><li><a href=#%e7%95%8c%e9%9d%a2%e8%af%b4%e6%98%8e-1 aria-label=界面说明>界面说明</a></li><li><a href=#%e8%af%ad%e6%b3%95%e8%a7%84%e5%88%99 aria-label=语法规则>语法规则</a></li><li><a href=#%e5%ba%94%e7%94%a8%e7%a4%ba%e4%be%8b aria-label=应用示例>应用示例</a></li></ul></li><li><a href=#%e6%98%be%e7%a4%ba%e8%bf%87%e6%bb%a4%e5%99%a8 aria-label=显示过滤器>显示过滤器</a><ul><li><a href=#%e5%9f%ba%e6%9c%ac%e8%bf%87%e6%bb%a4%e8%a1%a8%e8%be%be%e5%bc%8f aria-label=基本过滤表达式>基本过滤表达式</a><ul><li><a href=#%e8%bf%87%e6%bb%a4%e9%a1%b9 aria-label=过滤项>过滤项</a></li><li><a href=#%e8%bf%87%e6%bb%a4%e5%85%b3%e7%b3%bb aria-label=过滤关系>过滤关系</a></li><li><a href=#%e8%bf%87%e6%bb%a4%e5%80%bc aria-label=过滤值>过滤值</a></li></ul></li><li><a href=#%e5%a4%8d%e5%90%88%e8%bf%87%e6%bb%a4%e8%a1%a8%e8%be%be%e5%bc%8f aria-label=复合过滤表达式>复合过滤表达式</a></li><li><a href=#%e5%b8%b8%e8%a7%81%e6%98%be%e7%a4%ba%e8%bf%87%e6%bb%a4%e9%9c%80%e6%b1%82%e5%8f%8a%e5%85%b6%e5%af%b9%e5%ba%94%e8%a1%a8%e8%be%be%e5%bc%8f aria-label=常见显示过滤需求及其对应表达式>常见显示过滤需求及其对应表达式</a><ul><li><a href=#%e6%95%b0%e6%8d%ae%e9%93%be%e8%b7%af%e5%b1%82 aria-label=数据链路层>数据链路层</a></li><li><a href=#%e7%bd%91%e7%bb%9c%e5%b1%82 aria-label=网络层>网络层</a></li><li><a href=#%e4%bc%a0%e8%be%93%e5%b1%82 aria-label=传输层>传输层</a></li><li><a href=#%e5%ba%94%e7%94%a8%e5%b1%82 aria-label=应用层>应用层</a></li></ul></li></ul></li></ul></li></ul></li><li><a href=#%e9%80%9a%e8%bf%87%e5%ae%9e%e9%aa%8c%e9%98%90%e8%bf%b0arp%e7%9a%84%e5%b7%a5%e4%bd%9c%e5%8e%9f%e7%90%86 aria-label=通过实验阐述ARP的工作原理>通过实验阐述ARP的工作原理</a><ul><li><a href=#arp%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b aria-label=ARP工作流程>ARP工作流程</a></li><li><a href=#%e5%ae%9e%e9%aa%8c%e6%ad%a5%e9%aa%a4%e5%8f%8a%e5%86%85%e5%ae%b9 aria-label=实验步骤及内容>实验步骤及内容</a><ul><li><a href=#arp%e5%91%bd%e4%bb%a4%e7%bb%83%e4%b9%a0 aria-label=ARP命令练习>ARP命令练习</a></li><li><a href=#%e6%8a%93%e5%8c%85%e5%88%86%e6%9e%90arp%e5%8d%8f%e8%ae%ae aria-label=抓包分析ARP协议>抓包分析ARP协议</a><ul><li><a href=#%e5%bd%93arp%e7%bc%93%e5%ad%98%e5%af%b9%e5%ba%94%e6%95%b0%e6%8d%ae%e4%b8%ba%e7%a9%ba%e6%97%b6 aria-label=当ARP缓存对应数据为空时>当ARP缓存对应数据为空时</a><ul><li><a href=#%e5%ae%9e%e9%aa%8c%e6%ad%a5%e9%aa%a4 aria-label=实验步骤>实验步骤</a></li></ul></li><li><a href=#%e7%bb%93%e6%9e%9c%e5%88%86%e6%9e%90 aria-label=结果分析>结果分析</a></li><li><a href=#%e5%bd%93arp%e7%bc%93%e5%ad%98%e5%af%b9%e5%ba%94%e6%95%b0%e6%8d%ae%e4%b8%8d%e4%b8%ba%e7%a9%ba%e6%97%b6 aria-label=当ARP缓存对应数据不为空时>当ARP缓存对应数据不为空时</a><ul><li><a href=#%e5%ae%9e%e9%aa%8c%e6%ad%a5%e9%aa%a4-1 aria-label=实验步骤>实验步骤</a></li></ul></li><li><a href=#%e7%bb%93%e6%9e%9c%e5%88%86%e6%9e%90-1 aria-label=结果分析>结果分析</a></li></ul></li></ul></li></ul></li><li><a href=#%e5%88%a9%e7%94%a8%e5%ae%9e%e9%aa%8c%e7%bb%93%e6%9e%9c%e5%88%86%e6%9e%90icmp%e5%8d%8f%e8%ae%ae%e7%9a%84%e6%8a%a5%e6%96%87%e7%bb%93%e6%9e%84%e5%ad%97%e6%ae%b5%e5%ae%9a%e4%b9%89 aria-label=利用实验结果分析ICMP协议的报文结构字段定义>利用实验结果分析ICMP协议的报文结构字段定义</a><ul><li><a href=#icmp%e8%af%a2%e9%97%ae%e6%8a%a5%e6%96%87 aria-label=ICMP询问报文>ICMP询问报文</a><ul><li><a href=#%e5%ae%9e%e9%aa%8c%e6%ad%a5%e9%aa%a4-2 aria-label=实验步骤>实验步骤</a></li></ul></li></ul></li><li><a href=#%e5%8f%82%e8%80%83 aria-label=参考>参考</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=要求>要求<a hidden class=anchor aria-hidden=true href=#要求>#</a></h1><ol><li>团队合作、合理分工、按组为单位进行</li><li>报告文字内容不可拷贝粘贴现有文献，应反映小组所做的工作，有分析，实践性的选题应有具体操作或者配置过程描述，辅以截图或实验数据</li><li>所交报告中应在最后注明组员分工、参考文献，报告字数3000-6000</li><li>不同班级的小组可选择相同的题目，但重复计数（由各班学委协调），不可多于3组，且报告内容不可相同，要求独立完成各组任务</li><li>除了个别综述性的选题，其它选题要求在实际平台上实践</li></ol><h1 id=选题>选题<a hidden class=anchor aria-hidden=true href=#选题>#</a></h1><blockquote><p><strong>基于网络嗅探软件（wireshark）的协议分析实验</strong></p></blockquote><ol><li>Wireshark的深入学习与掌握，如过滤器的使用，归纳方法</li><li>通过实验阐述ARP的工作原理</li><li>利用实验结果分析ICMP协议的报文结构字段定义</li><li>基于实验数据深入分析TCP协议的连接过程原理，报文的分片等功能</li><li>从校园网发起向外网中某Web服务器的访问，记录并分析从MAC层协议、IP协议、TCP协议一直到HTTP协议的过程</li></ol><h1 id=基于网络嗅探软件wireshark的协议分析实验>基于网络嗅探软件Wireshark的协议分析实验<a hidden class=anchor aria-hidden=true href=#基于网络嗅探软件wireshark的协议分析实验>#</a></h1><h2 id=wireshark-是什么>Wireshark 是什么？<a hidden class=anchor aria-hidden=true href=#wireshark-是什么>#</a></h2><blockquote><p><strong>Wirkshark 是一个功能十分强大的开源的网络数据包分析器，能够在多种平台上抓取和分析网络包</strong></p><p><strong>Wirkshark 可被用于检查安全问题和解决网络问题，也可供开发者调试协议的实现和学习网络协议的原理</strong></p><p><strong>Wireshark使用 Npcap or WinPcap 作为接口，直接与网卡进行数据报文交换</strong></p></blockquote><h2 id=wireshark-下载与安装>Wireshark 下载与安装<a hidden class=anchor aria-hidden=true href=#wireshark-下载与安装>#</a></h2><p>官网地址：<a href=https://www.wireshark.org/>https://www.wireshark.org/</a>，直接点击下一步下一步安装即可<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636eef0324bca.png><img src=https://bu.dusays.com/2022/11/12/636eef0324bca.png alt=1></a></div>但是，我在安装过程中报了如下的错误：<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/11/636e699429bad.png><img src=https://bu.dusays.com/2022/11/11/636e699429bad.png alt=npcap></a></div>排查了好久，没找到合适的解决办法<br>最后，下载 WinPcap 来代替 Npcap ，成功运行。</p><h2 id=wireshark-基本用法>Wireshark 基本用法<a hidden class=anchor aria-hidden=true href=#wireshark-基本用法>#</a></h2><blockquote><p>简单抓包基础步骤：选择捕获接口 -> 获取网络实时痕迹 -> 获取报文 -> 深入解析</p></blockquote><hr><h3 id=选择接口网卡>选择接口（网卡）<a hidden class=anchor aria-hidden=true href=#选择接口网卡>#</a></h3><blockquote><p><strong>网络上传输的数据包需要经过网卡到达计算机，Wireshark可以捕获流经网卡的数据包</strong></p></blockquote><p>在使用Wireshark捕获数据前，先要选择捕获接口。一台计算机可能会有不止一个网卡，此时需要选择你要捕获数据的接口。</p><p>选择菜单栏上的 捕获->选项<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636eef03d463f.png><img src=https://bu.dusays.com/2022/11/12/636eef03d463f.png alt=1></a></div>选择想要捕获数据的接口后，点击开始<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636ef1eb47349.png><img src=https://bu.dusays.com/2022/11/12/636ef1eb47349.png alt=2></a></div></p><h3 id=界面说明>界面说明<a hidden class=anchor aria-hidden=true href=#界面说明>#</a></h3><p>开始捕获后，Wireshark会把捕获到的报文显示到界面上</p><ol><li><strong>显示过滤器</strong>用于设置过滤条件进行数据列表区数据过滤</li><li><strong>数据列表区</strong>展示的是Wireshark捕获到的所有数据包的列表，每个数据包包含 编号、时间戳、源地址、目标地址、协议、长度以及数据包信息</li><li><strong>数据详细区</strong>展示的是在数据列表区中选中的数据包的分协议展示<ol><li><u>Frame</u>：物理层的数据帧概况</li><li><u>Ethernet II</u>：数据链路层以太网帧头部信息</li><li><u>Internet Protocol Version 4</u>： 互联网层IP包头部信息</li><li><u>Transmission Control Protocol</u>：传输层的数据段头部信息，此处是TCP</li></ol></li><li><strong>数据字节区</strong>展示的是选中的数据包的源数据。另外，在数据详细区选中的某层或某字段，对应的数据会在数据字节区中高亮<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636efb5f7ea6d.png><img src=https://bu.dusays.com/2022/11/12/636efb5f7ea6d.png alt=1></a></div></li></ol><h3 id=过滤器设置>过滤器设置<a hidden class=anchor aria-hidden=true href=#过滤器设置>#</a></h3><blockquote><p><strong>根据我们想要抓取的数据包，对过滤器进行设置。过滤掉冗余的数据包，找到我们需要的信息</strong></p></blockquote><h4 id=捕获过滤器>捕获过滤器<a hidden class=anchor aria-hidden=true href=#捕获过滤器>#</a></h4><blockquote><p><strong>捕获过滤器表达式作用在Wireshark捕获数据包之前，只捕获符合条件的数据包</strong></p><p><strong>当需要处理大量数据时，使用捕获过滤器可以节省大量资源</strong></p></blockquote><h5 id=界面说明-1>界面说明<a hidden class=anchor aria-hidden=true href=#界面说明-1>#</a></h5><p>选择菜单栏上的 捕获->捕获过滤器<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636efe3d72678.png><img src=https://bu.dusays.com/2022/11/12/636efe3d72678.png alt=1></a></div>点击 <code>+</code> 即可添加新的过滤规则<br><code>Filter Name</code> 指代过滤器名称，用来给自己看该过滤器的过滤效果<br><code>Filter Expression</code> 指代过滤器表达式，需要使用 <code>Berkeley Packet Filter</code> 语法书写<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636efe3e2ce20.png><img src=https://bu.dusays.com/2022/11/12/636efe3e2ce20.png alt=2></a></div></p><h5 id=语法规则>语法规则<a hidden class=anchor aria-hidden=true href=#语法规则>#</a></h5><p>捕获过滤器使用 <code>BPF</code> 语法，表达式由多个原语组成：</p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>原语(primitives)：由名称或数字，以及描述它的多个限定词组成。  
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>*</span> 限定词(qualifiers)
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>*</span> Types：设置数字或者名称所指示类型，例如host www.baidu.com，如果没有指定此值，则默认使用“host”关键字
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>*</span> host、post
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>*</span> net，设定子网， net 192.168.0.0 mask 255.255.255.0等价于net 192.168.0.0/24
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>*</span> port，设置端口范围，例如port 6000-8000
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>*</span> Dir：设置网络出入方向，例如dst port 80，如果没有特别指明来源或目的地，则默认使用“src or dst”作为关键字
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>*</span> src、dst、src or dst、src and dst(src：源端口，dst：目标端口)
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>*</span> Proto：指定协议类型，例如udp，如果没有特别指明是什么协议，则默认使用所有支持的协议
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>*</span> ether、fddi、tr、wlan、ip、ip6、arp、rarp、decnet、tcp、udp、icmp、igmp、icmp、igrp、pim、ah、esp、vrrp
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>*</span> 其他
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>*</span> gateway：指明网关IP地址，等价于ether host &#39;ehost&#39; and not host &#39;host&#39;
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>*</span> broadcast：广播报文，例如ether broadcast或者ip broadcast
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>*</span> multicast：多播报文，例如ip multicast或者ip6 multicast
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>*</span> less、greater：小于或者大于
</span></span><span style=display:flex><span>  <span style=color:#fff;font-weight:700>*</span> 原语运算符
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>*</span> 与：<span style=color:red>&amp;&amp;</span>或者and
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>*</span> 或：||或者or
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>*</span> 非：!或者not
</span></span></code></pre></div><div style="color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px">转载自：https://juejin.cn/post/6844904066229747720</div><h5 id=应用示例>应用示例<a hidden class=anchor aria-hidden=true href=#应用示例>#</a></h5><p>只抓取源端口或者目的端口范围6000到8000，并且是一个tcp协议或者ipv6的数据包</p><pre tabindex=0><code>src or dst port 6000-8000 &amp;&amp; tcp or ip6    
</code></pre><p>只抓取IP地址为192.168.0.10的数据包</p><pre tabindex=0><code>host 192.168.0.10
</code></pre><h4 id=显示过滤器>显示过滤器<a hidden class=anchor aria-hidden=true href=#显示过滤器>#</a></h4><blockquote><p><strong>显示过滤器表达式作用在在Wireshark捕获数据包之后，从已捕获的所有数据包中显示出符合条件的数据包</strong></p></blockquote><p>显示过滤表达式在工具栏下方的“应用显示过滤器”输入框输入即可生效<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636f11a82564a.png><img src=https://bu.dusays.com/2022/11/12/636f11a82564a.png alt=1></a></div></p><h5 id=基本过滤表达式>基本过滤表达式<a hidden class=anchor aria-hidden=true href=#基本过滤表达式>#</a></h5><ol><li>一条基本的表达式由<strong>过滤项</strong>、<strong>过滤关系</strong>、<strong>过滤值</strong>三项组成</li><li>例如：<code>ip.addr == 192.168.1.1</code>，其中 <code>ip.addr</code> 为过滤项，<code>==</code> 为过滤关系，<code>192.168.1.1</code> 为过滤值。</li><li>该表达式的意思是 <strong>找出所有ip协议中源或目标ip等于192.168.1.1的数据包</strong></li></ol><h6 id=过滤项>过滤项<a hidden class=anchor aria-hidden=true href=#过滤项>#</a></h6><ol><li>Wireshark的过滤项是 <code>协议.协议字段</code> 的模式，Wireshark支持的全部协议及协议字段可查看<a href=https://www.wireshark.org/docs/dfref/>官方说明</a>。</li><li>以端口为例，端口出现于tcp协议中。所以有端口这个过滤项且其写法就是tcp.port</li><li>Wireshark出于缩减长度的原因，有些字段没有使用协议规定的名称而是使用简写，比如Destination Port在Wireshark中写为dstport</li><li>Wireshark出于简便使用的原因，增加了一些协议中没有的字段，比如tcp协议只有源端口和目标端口字段，为了简便使用Wireshark增加了tcp.port来同时代表这两个字段</li><li>实际使用时我们输入<code>协议.</code>后Wireshark就会有支持的字段提示</li></ol><h6 id=过滤关系>过滤关系<a hidden class=anchor aria-hidden=true href=#过滤关系>#</a></h6><p>过滤关系指的是大于、等于、小于等等式关系，具体可以看<a href=https://www.wireshark.org/docs/wsug_html/#DispCompOps>官方给出的表</a><div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636f11ecb35db.png><img src=https://bu.dusays.com/2022/11/12/636f11ecb35db.png alt=1></a></div></p><h6 id=过滤值>过滤值<a hidden class=anchor aria-hidden=true href=#过滤值>#</a></h6><p>过滤值就是设定的过滤项应该满足过滤关系的标准，比如500、5000、50000等等。<br>过滤值的写法一般已经被过滤项和过滤关系设定好了，只是填下自己的期望值就可以了。</p><h5 id=复合过滤表达式>复合过滤表达式<a hidden class=anchor aria-hidden=true href=#复合过滤表达式>#</a></h5><p>所谓复合过滤表达示，就是指由多条基本过滤表达式组合而成的表达示。<br>基本过滤表达式的写法还是不变的，复合过滤表达示多出来的东西就只是基本过滤表达示的“连接词”，我们依然直接参照<a href=https://www.wireshark.org/docs/wsug_html/#FiltLogOps>官方给出的表</a><div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636f11cc4be71.png><img src=https://bu.dusays.com/2022/11/12/636f11cc4be71.png alt=1></a></div></p><h5 id=常见显示过滤需求及其对应表达式>常见显示过滤需求及其对应表达式<a hidden class=anchor aria-hidden=true href=#常见显示过滤需求及其对应表达式>#</a></h5><h6 id=数据链路层>数据链路层<a hidden class=anchor aria-hidden=true href=#数据链路层>#</a></h6><pre tabindex=0><code>筛选mac地址为04:f9:38:ad:13:26的数据包----eth.src == 04:f9:38:ad:13:26

筛选源mac地址为04:f9:38:ad:13:26的数据包----eth.src == 04:f9:38:ad:13:26
</code></pre><h6 id=网络层>网络层<a hidden class=anchor aria-hidden=true href=#网络层>#</a></h6><pre tabindex=0><code>筛选ip地址为192.168.1.1的数据包----ip.addr == 192.168.1.1

筛选192.168.1.0网段的数据---- ip contains &#34;192.168.1&#34;

筛选192.168.1.1和192.168.1.2之间的数据包----ip.addr == 192.168.1.1 &amp;&amp; ip.addr == 192.168.1.2

筛选从192.168.1.1到192.168.1.2的数据包----ip.src == 192.168.1.1 &amp;&amp; ip.dst == 192.168.1.2
</code></pre><h6 id=传输层>传输层<a hidden class=anchor aria-hidden=true href=#传输层>#</a></h6><pre tabindex=0><code>筛选tcp协议的数据包----tcp

筛选除tcp协议以外的数据包----!tcp

筛选端口为80的数据包----tcp.port == 80

筛选12345端口和80端口之间的数据包----tcp.port == 12345 &amp;&amp; tcp.port == 80

筛选从12345端口到80端口的数据包----tcp.srcport == 12345 &amp;&amp; tcp.dstport == 80
</code></pre><h6 id=应用层>应用层<a hidden class=anchor aria-hidden=true href=#应用层>#</a></h6><pre tabindex=0><code>特别说明----http中http.request表示请求头中的第一行（如GET index.jsp HTTP/1.1），http.response表示响应头中的第一行（如HTTP/1.1 200 OK），其他头部都用http.header_name形式。

筛选url中包含.php的http数据包----http.request.uri contains &#34;.php&#34;

筛选内容包含username的http数据包----http contains &#34;username&#34;
</code></pre><h2 id=通过实验阐述arp的工作原理>通过实验阐述ARP的工作原理<a hidden class=anchor aria-hidden=true href=#通过实验阐述arp的工作原理>#</a></h2><blockquote><p><strong>ARP即地址解析协议（Address Resolution Protocol），是根据IP地址获取MAC地址的一个TCP/IP协议</strong></p><p><strong>ARP用于解决同一个局域网上的主机或路由器的IP地址和MAC地址的映射问题</strong></p><p><strong>每一台主机都设有一个 ARP高速缓存，里面存有 本局域网上 各主机和路由器的IP地址到MAC地址的映射表</strong></p></blockquote><h3 id=arp工作流程>ARP工作流程<a hidden class=anchor aria-hidden=true href=#arp工作流程>#</a></h3><ol><li>当主机A要向<strong>本局域网</strong>上的某台主机B发送IP数据报时，就现在其ARP高速缓存中查找有无主机B的IP地址。若有，查出其对应的MAC地址，写入MAC帧；若没有，进行下述步骤</li><li>主机A的ARP进程在本局域网上广播一个ARP请求分组，其中有自己的IP地址到MAC地址的映射</li><li>本局域网上的所有主机运行的ARP进程都收到此ARP请求分组</li><li>主机B的IP地址与ARP请求分组中要查询的IP地址一致，就收下这个ARP请求分组，将主机A的MAC映射写入自己的ARP高速缓存，并向主机A发送ARP响应分组，同时在这个ARP响应分组中写入自己的MAC地址。由于其余所有主机的IP地址都与ARP请求分组中要查询的IP地址不一致，因此不理睬</li><li>主机A收到主机B的ARP响应分组后，就在其ARP高速缓存中写入主机B的IP地址到MAC地址的映射</li></ol><h3 id=实验步骤及内容>实验步骤及内容<a hidden class=anchor aria-hidden=true href=#实验步骤及内容>#</a></h3><blockquote><p><strong>主机A</strong></p><p><strong>IP地址：192.168.31.248</strong></p><p><strong>MAC地址：c0:3c:59:5e:37:47</strong></p><p><strong>主机B</strong></p><p><strong>IP地址：192.168.31.186</strong></p><p><strong>MAC地址：28:7f:cf:12:af:89</strong></p></blockquote><h4 id=arp命令练习>ARP命令练习<a hidden class=anchor aria-hidden=true href=#arp命令练习>#</a></h4><ol><li>在<code>cmd</code>中使用<code>ipconfig/all</code>命令，查看自己的IP地址和MAC地址，同时让小组成员连接同一个<code>WIFI</code>执行相同的操作并记录</li></ol><center><img style="border-radius:.3125em;box-shadow:0 2px 4px rgba(34,36,38,.12),0 2px 10px rgba(34,36,38,8%)" src=https://bu.dusays.com/2022/11/12/636f62756d2e9.png><br><div style="color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px">我的 IP地址和MAC地址</div></center><center><img style="border-radius:.3125em;box-shadow:0 2px 4px rgba(34,36,38,.12),0 2px 10px rgba(34,36,38,8%)" src=https://bu.dusays.com/2022/11/12/636f6331a7d39.png><br><div style="color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px">小组成员的 IP地址和MAC地址</div></center><ol start=2><li>使用<code>arp -a</code>查看ARP缓存表<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636f603bde062.png><img src=https://bu.dusays.com/2022/11/12/636f603bde062.png alt=1></a></div></li><li>使用<code>ping</code>小组成员的IP添加动态ARP表项<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636f60cfe4604.png><img src=https://bu.dusays.com/2022/11/12/636f60cfe4604.png alt=2></a></div>我在<code>ping</code>小组成员<code>ip</code>地址时碰到<strong>请求超时</strong>的问题。<br>经排查，是因为windows防火墙默认设置的是不让别人ping通，通过修改防火墙相关设置解决了该问题。<br><strong>步骤：控制面板 →  系统和安全 → Windows防火墙 → 高级设置 → 入站规则 → 文件和打印机共享（回显请求 - ICMPv4-In）设置为启用</strong></li><li>使用<code>arp -a</code>查看ARP缓存表，发生新增一条数据<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636f6169b6f50.png><img src=https://bu.dusays.com/2022/11/12/636f6169b6f50.png alt=3></a></div></li><li>以管理员身份运行<code>cmd</code>，执行<code>arp -d *</code>，删除缓存信息<div class=post-img-view><a data-fancybox=gallery href=https://bu.dusays.com/2022/11/12/636f62661400d.png><img src=https://bu.dusays.com/2022/11/12/636f62661400d.png alt=4></a></div></li></ol><h4 id=抓包分析arp协议>抓包分析ARP协议<a hidden class=anchor aria-hidden=true href=#抓包分析arp协议>#</a></h4><h5 id=当arp缓存对应数据为空时>当ARP缓存对应数据为空时<a hidden class=anchor aria-hidden=true href=#当arp缓存对应数据为空时>#</a></h5><h6 id=实验步骤>实验步骤<a hidden class=anchor aria-hidden=true href=#实验步骤>#</a></h6><ol><li>主机A执行<code>arp -d *</code>，删除缓存信息</li><li>主机A运行Wireshark，设置显示过滤器表达式为<code>arp.dst.proto_ipv4 == 192.168.31.186 and arp.src.proto_ipv4 == 192.168.31.248 or icmp</code></li><li>主机A<code>ping</code>主机B的<code>ip地址</code></li></ol><h5 id=结果分析>结果分析<a hidden class=anchor aria-hidden=true href=#结果分析>#</a></h5><ol><li>主机A将自己的<code>ip地址 192.168.31.248</code> & <code>MAC地址 c0:3c:59:5e:37:47</code>写入请求分组，并将<code>目的ip地址</code>设置为<code>192.168.31.186</code>，<code>目的MAC地址</code>设置为<code>00:00:00:00:00:00</code>，对本局域网内的所有主机进行广播</li></ol><center><img style="border-radius:.3125em;box-shadow:0 2px 4px rgba(34,36,38,.12),0 2px 10px rgba(34,36,38,8%)" src=https://bu.dusays.com/2022/11/12/636f8f33f1a20.png><br><div style="color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px">主机A发出的ARP请求分组</div></center><ol start=2><li>主机B收下这个ARP请求分组，将主机A的MAC映射写入自己的ARP高速缓存，并向主机A发送ARP响应分组，同时在这个ARP响应分组中写入自己的MAC地址，即<code>28:7f:cf:12:af:89</code></li><li>主机A收到主机B的ARP响应分组后，就在其ARP高速缓存中写入主机B的IP地址到MAC地址的映射</li></ol><center><img style="border-radius:.3125em;box-shadow:0 2px 4px rgba(34,36,38,.12),0 2px 10px rgba(34,36,38,8%)" src=https://bu.dusays.com/2022/11/12/636f8e7d3f758.png><br><div style="color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px">主机A收到的来自主机B的ARP响应分组</div></center><center><img style="border-radius:.3125em;box-shadow:0 2px 4px rgba(34,36,38,.12),0 2px 10px rgba(34,36,38,8%)" src=https://bu.dusays.com/2022/11/12/636f8ea2d8434.png><br><div style="color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px">主机A的ARP高速缓存表</div></center><h5 id=当arp缓存对应数据不为空时>当ARP缓存对应数据不为空时<a hidden class=anchor aria-hidden=true href=#当arp缓存对应数据不为空时>#</a></h5><h6 id=实验步骤-1>实验步骤<a hidden class=anchor aria-hidden=true href=#实验步骤-1>#</a></h6><ol><li>主机A运行Wireshark，设置显示过滤器表达式为<code>arp.dst.proto_ipv4 == 192.168.31.186 and arp.src.proto_ipv4 == 192.168.31.248 or icmp</code></li><li>主机B运行Wireshark，设置显示过滤器表达式为<code>arp.dst.proto_ipv4 == 192.168.31.248 and arp.src.proto_ipv4 == 192.168.31.186 or icmp</code></li><li>主机A <code>ping</code>主机B的<code>ip地址</code></li></ol><h5 id=结果分析-1>结果分析<a hidden class=anchor aria-hidden=true href=#结果分析-1>#</a></h5><p>主机A没有发出<code>ARP</code>请求，而主机B接受到了主机A的ICMP报文，说明主机A直接使用了高速缓存区内的对应数据</p><center><img style="border-radius:.3125em;box-shadow:0 2px 4px rgba(34,36,38,.12),0 2px 10px rgba(34,36,38,8%)" src=https://bu.dusays.com/2022/11/12/636f910b7f31d.png><br><div style="color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px">主机A发出的报文</div></center><center><img style="border-radius:.3125em;box-shadow:0 2px 4px rgba(34,36,38,.12),0 2px 10px rgba(34,36,38,8%)" src=https://bu.dusays.com/2022/10/26/635911c150be7.jpg><br><div style="color:orange;border-bottom:1px solid #d9d9d9;display:inline-block;color:#999;padding:2px">主机B接受到的来自主机A的报文</div></center><h2 id=利用实验结果分析icmp协议的报文结构字段定义>利用实验结果分析ICMP协议的报文结构字段定义<a hidden class=anchor aria-hidden=true href=#利用实验结果分析icmp协议的报文结构字段定义>#</a></h2><blockquote><p><strong>ICMP即互联网控制报文协议（Internet Control Message Protocol），网络设备（包括路由器）使用它来发送错误消息和指示与另一个IP 地址通信时成功或失败的操作信息</strong></p></blockquote><h3 id=icmp询问报文>ICMP询问报文<a hidden class=anchor aria-hidden=true href=#icmp询问报文>#</a></h3><h4 id=实验步骤-2>实验步骤<a hidden class=anchor aria-hidden=true href=#实验步骤-2>#</a></h4><ol><li></li></ol><h2 id=参考>参考<a hidden class=anchor aria-hidden=true href=#参考>#</a></h2><ol><li><a href=https://blog.51cto.com/yttitan/1734425>Wireshark系列之4 捕获过滤器</a></li><li><a href="https://blog.51cto.com/u_13579643/3647795?articleABtest=0">网络——Wireshark工具</a></li><li><a href=https://juejin.cn/post/6844904066229747720>WireShark的基本用法</a></li><li><a href=https://www.cnblogs.com/lsdb/p/9254544.html>Wireshark使用教程（界面说明、捕获过滤器表达式、显示过滤器表达式）</a></li><li><a href=https://www.freebuf.com/sectool/256745.html>一文精讲Wireshark的抓包和分析</a></li><li><a href=https://bbs.huaweicloud.com/blogs/285673>Wireshark简明教程，新手专用，挑实在的讲，不搞花里胡哨</a></li><li><a href=https://blog.51cto.com/u_15688254/5694733>WireShark网络封包抓包工具各个界面介绍</a></li><li><a href=https://codeantenna.com/a/2zI6hbfTIM>实验3.利用Wireshark分析ARP协议</a></li><li><a href=https://www.wireshark.org/docs/wsug_html_chunked/ChapterWork.html>Wireshark官方文档</a></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://xancoding.cn/tags/tech/>Tech</a></li><li><a href=https://xancoding.cn/tags/wireshark/>Wireshark</a></li><li><a href=https://xancoding.cn/tags/%E5%B7%A5%E5%85%B7/>工具</a></li><li><a href=https://xancoding.cn/tags/%E6%96%B0%E6%8A%80%E8%83%BD/>新技能</a></li><li><a href=https://xancoding.cn/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/>计算机网络</a></li></ul><nav class=paginav><a class=next href=https://xancoding.cn/posts/vimium/><span class=title>Next »</span><br><span>Vimium学习记</span></a></nav></footer><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>💬评论</span><hr></div><div id=tcomment></div><script src=https://cdn.staticfile.org/twikoo/1.6.7/twikoo.all.min.js></script>
<script>twikoo.init({envId:"https://twikoo.xancoding.cn/",el:"#tcomment",lang:"zh-CN",region:"ap-beijing",path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><span>&copy; 2022 <a href=https://xancoding.cn>Xan's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>