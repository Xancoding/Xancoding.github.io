<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Xan&#39;s Blog</title>
    <link>https://xancoding.github.io/</link>
    <description>Recent content on Xan&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Tue, 11 Oct 2022 19:52:46 +0800</lastBuildDate><atom:link href="https://xancoding.github.io/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>观光之旅</title>
      <link>https://xancoding.github.io/posts/sight/</link>
      <pubDate>Tue, 11 Oct 2022 19:52:46 +0800</pubDate>
      
      <guid>https://xancoding.github.io/posts/sight/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/problem/content/346/&#34;&gt;观光之旅&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;namespace&lt;/span&gt; std ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; N = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;110&lt;/span&gt; , M = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;10010&lt;/span&gt; , INF = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x3f3f3f3f&lt;/span&gt; ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;long&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;long&lt;/span&gt; LL ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; n, m;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; g[N][N];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; d[N][N];  &lt;span style=&#34;color:#007f7f&#34;&gt;// 最短距离
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; pos[N][N];  &lt;span style=&#34;color:#007f7f&#34;&gt;// pos[i][j] = k  从 i 到 j 的最短路径是从 k 转移来的
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; path[N], cnt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// 当前最小环的方案
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// 递归加入从 i 到 j 的中间路径
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; get_path(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (pos[i][j] == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; k = pos[i][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    get_path(i, k);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    path[cnt ++] = k;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    get_path(k, j);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    memset(g, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x3f&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt; g);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt;= n; i ++) g[i][i] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; (m --) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; a, b, c;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        cin &amp;gt;&amp;gt; a &amp;gt;&amp;gt; b &amp;gt;&amp;gt; c;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        g[a][b] = g[b][a] = min(g[a][b], c);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; res = INF;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    memcpy(d, g, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt; g);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; k = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; k &amp;lt;= n; ++ k) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#007f7f&#34;&gt;// 枚举以 k 为最大编号的环
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#007f7f&#34;&gt;// 由于是无向图，i j 顺序可互换，所以不用都枚举
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt; k; ++ i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j = i + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; j &amp;lt; k; ++ j)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; ((LL)d[i][j] + g[i][k] + g[k][j] &amp;lt; res) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    res = d[i][j] + g[i][k] + g[k][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    cnt = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    path[cnt ++] = k;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    path[cnt ++] = i;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    get_path(i, j);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    path[cnt ++] = j;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#007f7f&#34;&gt;// floyd
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt;= n; ++ i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; j &amp;lt;= n; ++ j)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (d[i][j] &amp;gt; d[i][k] + d[k][j]) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    d[i][j] = d[i][k] + d[k][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    pos[i][j] = k;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (res == INF) puts(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;No solution.&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; cnt; ++ i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            cout &amp;lt;&amp;lt; path[i] &amp;lt;&amp;lt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        cout &amp;lt;&amp;lt; endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
      <content:encoded><![CDATA[<p><a href="https://www.acwing.com/problem/content/346/">观光之旅</a></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span><span style="color:#0f0;font-weight:bold">&lt;bits/stdc++.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold"></span><span style="color:#fff;font-weight:bold">using</span> <span style="color:#fff;font-weight:bold">namespace</span> std ;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">const</span> <span style="color:#fff;font-weight:bold">int</span> N = <span style="color:#ff0;font-weight:bold">110</span> , M = <span style="color:#ff0;font-weight:bold">10010</span> , INF = <span style="color:#ff0;font-weight:bold">0x3f3f3f3f</span> ;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">typedef</span> <span style="color:#fff;font-weight:bold">long</span> <span style="color:#fff;font-weight:bold">long</span> LL ;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> n, m;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> g[N][N];
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> d[N][N];  <span style="color:#007f7f">// 最短距离
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">int</span> pos[N][N];  <span style="color:#007f7f">// pos[i][j] = k  从 i 到 j 的最短路径是从 k 转移来的
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">int</span> path[N], cnt;  <span style="color:#007f7f">// 当前最小环的方案
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// 递归加入从 i 到 j 的中间路径
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">void</span> get_path(<span style="color:#fff;font-weight:bold">int</span> i, <span style="color:#fff;font-weight:bold">int</span> j) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (pos[i][j] == <span style="color:#ff0;font-weight:bold">0</span>) <span style="color:#fff;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> k = pos[i][j];
</span></span><span style="display:flex;"><span>    get_path(i, k);
</span></span><span style="display:flex;"><span>    path[cnt ++] = k;
</span></span><span style="display:flex;"><span>    get_path(k, j);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> main() {
</span></span><span style="display:flex;"><span>    cin &gt;&gt; n &gt;&gt; m;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    memset(g, <span style="color:#ff0;font-weight:bold">0x3f</span>, <span style="color:#fff;font-weight:bold">sizeof</span> g);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = <span style="color:#ff0;font-weight:bold">1</span>; i &lt;= n; i ++) g[i][i] = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> (m --) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> a, b, c;
</span></span><span style="display:flex;"><span>        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;
</span></span><span style="display:flex;"><span>        g[a][b] = g[b][a] = min(g[a][b], c);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> res = INF;
</span></span><span style="display:flex;"><span>    memcpy(d, g, <span style="color:#fff;font-weight:bold">sizeof</span> g);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> k = <span style="color:#ff0;font-weight:bold">1</span>; k &lt;= n; ++ k) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// 枚举以 k 为最大编号的环
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#007f7f">// 由于是无向图，i j 顺序可互换，所以不用都枚举
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = <span style="color:#ff0;font-weight:bold">1</span>; i &lt; k; ++ i)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> j = i + <span style="color:#ff0;font-weight:bold">1</span>; j &lt; k; ++ j)
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">if</span> ((LL)d[i][j] + g[i][k] + g[k][j] &lt; res) {
</span></span><span style="display:flex;"><span>                    res = d[i][j] + g[i][k] + g[k][j];
</span></span><span style="display:flex;"><span>                    cnt = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>                    path[cnt ++] = k;
</span></span><span style="display:flex;"><span>                    path[cnt ++] = i;
</span></span><span style="display:flex;"><span>                    get_path(i, j);
</span></span><span style="display:flex;"><span>                    path[cnt ++] = j;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// floyd
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = <span style="color:#ff0;font-weight:bold">1</span>; i &lt;= n; ++ i)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> j = <span style="color:#ff0;font-weight:bold">1</span>; j &lt;= n; ++ j)
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">if</span> (d[i][j] &gt; d[i][k] + d[k][j]) {
</span></span><span style="display:flex;"><span>                    d[i][j] = d[i][k] + d[k][j];
</span></span><span style="display:flex;"><span>                    pos[i][j] = k;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (res == INF) puts(<span style="color:#0ff;font-weight:bold">&#34;No solution.&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = <span style="color:#ff0;font-weight:bold">0</span>; i &lt; cnt; ++ i)
</span></span><span style="display:flex;"><span>            cout &lt;&lt; path[i] &lt;&lt; <span style="color:#0ff;font-weight:bold">&#39; &#39;</span>;
</span></span><span style="display:flex;"><span>        cout &lt;&lt; endl;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Django</title>
      <link>https://xancoding.github.io/posts/django/</link>
      <pubDate>Tue, 11 Oct 2022 19:43:26 +0800</pubDate>
      
      <guid>https://xancoding.github.io/posts/django/</guid>
      <description>&lt;p&gt;[[Redis]]&lt;/p&gt;
&lt;h1 id=&#34;django&#34;&gt;Django&lt;/h1&gt;
&lt;h2 id=&#34;用户名密码登录&#34;&gt;用户名密码登录&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/video/3550/&#34;&gt;6.1用户名密码登录-Vedio&lt;/a&gt;
数据表定义：11m02s~21m02s
views &amp;amp; urls &amp;amp; js：25m01s~32m50s~33m37s~47m30s
将头像渲染到角色上：48m~50m20s
登陆界面 HTML+CSS：57m10s~1h42m30s~1h49m56s
登陆界面 逻辑实现：1h50m~1h53m47s~1h58m41s~2h20s~2h32m40s
&lt;a href=&#34;https://www.acwing.com/solution/content/79314/&#34;&gt;6.1 上课笔记&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/solution/content/75831/&#34;&gt;6.1 上课笔记——&lt;strong&gt;客户端请求与Django响应流程&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;我们在定义完一个数据表之后，需要将其&lt;strong&gt;更新到数据库&lt;/strong&gt;，这时候我们需要执行两句话：&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
python3 manage.py makemigrations
python3 manage.py migrate
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;客户端请求与Django响应流程&lt;/strong&gt;
用户在客户端通过&lt;code&gt;$.ajax&lt;/code&gt;发送请求，根据&lt;code&gt;urls&lt;/code&gt;路由到对应的&lt;code&gt;views&lt;/code&gt;中的函数，处理&lt;code&gt;request&lt;/code&gt;后返回&lt;code&gt;JsonResponse&lt;/code&gt; 至客户端&lt;/p&gt;
&lt;p&gt;&lt;code&gt;views&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-py&#34; data-lang=&#34;py&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;from&lt;/span&gt; django.http &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; JsonResponse
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;from&lt;/span&gt; django.contrib.auth &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; authenticate, login
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;def&lt;/span&gt; signin(request):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    data = request.GET &lt;span style=&#34;color:#007f7f&#34;&gt;# 获取请求的信息&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    username = data.get(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#007f7f&#34;&gt;# 用户名&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    password = data.get(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#007f7f&#34;&gt;# 密码&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    user = authenticate(username = username, password = password) &lt;span style=&#34;color:#007f7f&#34;&gt;# 从数据库中查找这个用户&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; not user: &lt;span style=&#34;color:#007f7f&#34;&gt;# 如果没有就直接返回不成功&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; JsonResponse({
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;result&amp;#39;&lt;/span&gt;: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;用户名或密码不正确&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        })
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   login(request, user) &lt;span style=&#34;color:#007f7f&#34;&gt;# 找到了就登录&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;urls&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-py&#34; data-lang=&#34;py&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;from&lt;/span&gt; game.views.settings.login &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; signin &lt;span style=&#34;color:#007f7f&#34;&gt;# 引入自己写的逻辑&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;urlpatterns = [
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    path(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;login/&amp;#34;&lt;/span&gt;, signin, name = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;settings_login&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#007f7f&#34;&gt;# &amp;#34;settings/login/&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;js&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;login_on_remote() &lt;span style=&#34;color:#007f7f&#34;&gt;// 在远程服务器上登录
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; outer = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;this&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; username = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;this&lt;/span&gt;.$login_username.val(); &lt;span style=&#34;color:#007f7f&#34;&gt;// 获取输入框中的用户名
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; password = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;this&lt;/span&gt;.$login_password.val(); &lt;span style=&#34;color:#007f7f&#34;&gt;// 获取输入框中的密码
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;this&lt;/span&gt;.$login_error_message.empty(); &lt;span style=&#34;color:#007f7f&#34;&gt;// 清楚错误信息
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    $.ajax({
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        url: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;登录URL&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#007f7f&#34;&gt;// 访问url
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;        type: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;GET&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        data: {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            username: username, &lt;span style=&#34;color:#007f7f&#34;&gt;// 传输数据
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;            password: password,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        success: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt;(resp){
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            console.log(resp); &lt;span style=&#34;color:#007f7f&#34;&gt;// 测试输出
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (resp.result === &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                location.reload(); &lt;span style=&#34;color:#007f7f&#34;&gt;// 如果成功就刷新
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                outer.$login_error_message.html(resp.result); &lt;span style=&#34;color:#007f7f&#34;&gt;// 如果失败就显示错误信息
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    });
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;第三方登录&#34;&gt;第三方登录&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/video/3565/&#34;&gt;6.2 web端AcWing一键登录-Vedio&lt;/a&gt;
在&lt;code&gt;django&lt;/code&gt;中集成数据库&lt;code&gt;redis&lt;/code&gt;：7m10s~13m20s
&lt;code&gt;redis&lt;/code&gt;命令：13m40s~16m34s
&lt;strong&gt;Oauth2一键授权登录的基本原理&lt;/strong&gt;：17m30s~29m15s~32m51s
数据表添加&lt;code&gt;openid&lt;/code&gt;信息：33m20s~34m47s
&lt;strong&gt;Oauth2一键授权登录的代码实现&lt;/strong&gt;：35m20s~1h25s~1h27m20s
用户点击&lt;code&gt;AcWing一键登录&lt;/code&gt;，通过&lt;code&gt;urls &amp;amp; views&lt;/code&gt;调用&lt;code&gt;apply_code&lt;/code&gt;函数，将&lt;code&gt;state&lt;/code&gt;放到&lt;code&gt;redis&lt;/code&gt;中，将&lt;code&gt;appid &amp;amp; redirect_uri &amp;amp; scope &amp;amp; state&lt;/code&gt; 传入&lt;code&gt;apply_code_url&lt;/code&gt;链接，返回并重定向至&lt;code&gt;apply_code_url&lt;/code&gt;向用户询问是否授权
用户点击&lt;code&gt;同意&lt;/code&gt;后，重定向至&lt;code&gt;redirect_uri&lt;/code&gt;链接，返回参数为&lt;code&gt;code&lt;/code&gt;和&lt;code&gt;state&lt;/code&gt;，通过&lt;code&gt;urls &amp;amp; views&lt;/code&gt;调用&lt;code&gt;receive_code&lt;/code&gt;函数。若验证&lt;code&gt;state&lt;/code&gt;失败，直接重定向至初始界面
若验证&lt;code&gt;state&lt;/code&gt;成功，将&lt;code&gt;appid &amp;amp; code &amp;amp; secret&lt;/code&gt;发送至&lt;code&gt;AcWing服务器&lt;/code&gt;，申请授权令牌&lt;code&gt;access_token&lt;/code&gt;和用户的&lt;code&gt;openid&lt;/code&gt;
若申请令牌成功，将&lt;code&gt;access_token &amp;amp; openid&lt;/code&gt;发送至&lt;code&gt;AcWing服务器&lt;/code&gt;，得到用户信息，创建并登录用户，最后重定向至初始界面
&lt;a href=&#34;https://www.acwing.com/blog/content/12466/&#34;&gt;6.2 &lt;strong&gt;Web端AcWing一键登录-讲义&lt;/strong&gt;&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/solution/content/79354/&#34;&gt;6.2 &lt;strong&gt;上课笔记&lt;/strong&gt;&lt;/a&gt;
&lt;code&gt;redirect_uri = quote(&amp;quot;https://app23.acapp.acwing.com.cn/settings/acwing/web/receive_code&amp;quot;)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/video/3566/&#34;&gt;6.3 acapp端AcWing一键登录-Vedio&lt;/a&gt;
&lt;strong&gt;Oauth2一键授权登录的基本原理&lt;/strong&gt;：10m~12m20s~16m35s~18m
&lt;strong&gt;Oauth2一键授权登录的代码实现&lt;/strong&gt;：19m25s~21m~23m25s~34m29s~42m10s
&lt;a href=&#34;https://www.acwing.com/blog/content/12467/&#34;&gt;6.3 acapp端AcWing一键登录-讲义&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/solution/content/79365/&#34;&gt;6.3 上课笔记&lt;/a&gt;&lt;/p&gt;
</description>
      <content:encoded><![CDATA[<p>[[Redis]]</p>
<h1 id="django">Django</h1>
<h2 id="用户名密码登录">用户名密码登录</h2>
<p><a href="https://www.acwing.com/video/3550/">6.1用户名密码登录-Vedio</a>
数据表定义：11m02s~21m02s
views &amp; urls &amp; js：25m01s~32m50s~33m37s~47m30s
将头像渲染到角色上：48m~50m20s
登陆界面 HTML+CSS：57m10s~1h42m30s~1h49m56s
登陆界面 逻辑实现：1h50m~1h53m47s~1h58m41s~2h20s~2h32m40s
<a href="https://www.acwing.com/solution/content/79314/">6.1 上课笔记</a>
<a href="https://www.acwing.com/solution/content/75831/">6.1 上课笔记——<strong>客户端请求与Django响应流程</strong></a></p>
<ul>
<li>我们在定义完一个数据表之后，需要将其<strong>更新到数据库</strong>，这时候我们需要执行两句话：</li>
</ul>
<pre tabindex="0"><code>
python3 manage.py makemigrations
python3 manage.py migrate
</code></pre><p><strong>客户端请求与Django响应流程</strong>
用户在客户端通过<code>$.ajax</code>发送请求，根据<code>urls</code>路由到对应的<code>views</code>中的函数，处理<code>request</code>后返回<code>JsonResponse</code> 至客户端</p>
<p><code>views</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> django.http <span style="color:#fff;font-weight:bold">import</span> JsonResponse
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> django.contrib.auth <span style="color:#fff;font-weight:bold">import</span> authenticate, login
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> signin(request):
</span></span><span style="display:flex;"><span>    data = request.GET <span style="color:#007f7f"># 获取请求的信息</span>
</span></span><span style="display:flex;"><span>    username = data.get(<span style="color:#0ff;font-weight:bold">&#39;username&#39;</span>) <span style="color:#007f7f"># 用户名</span>
</span></span><span style="display:flex;"><span>    password = data.get(<span style="color:#0ff;font-weight:bold">&#39;password&#39;</span>) <span style="color:#007f7f"># 密码</span>
</span></span><span style="display:flex;"><span>    user = authenticate(username = username, password = password) <span style="color:#007f7f"># 从数据库中查找这个用户</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> not user: <span style="color:#007f7f"># 如果没有就直接返回不成功</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> JsonResponse({
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">&#39;result&#39;</span>: <span style="color:#0ff;font-weight:bold">&#34;用户名或密码不正确&#34;</span>
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>   login(request, user) <span style="color:#007f7f"># 找到了就登录</span>
</span></span></code></pre></div><p><code>urls</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> game.views.settings.login <span style="color:#fff;font-weight:bold">import</span> signin <span style="color:#007f7f"># 引入自己写的逻辑</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>urlpatterns = [
</span></span><span style="display:flex;"><span>    path(<span style="color:#0ff;font-weight:bold">&#34;login/&#34;</span>, signin, name = <span style="color:#0ff;font-weight:bold">&#34;settings_login&#34;</span>), <span style="color:#007f7f"># &#34;settings/login/&#34;</span>
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p><code>js</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>login_on_remote() <span style="color:#007f7f">// 在远程服务器上登录
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">let</span> outer = <span style="color:#fff;font-weight:bold">this</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">let</span> username = <span style="color:#fff;font-weight:bold">this</span>.$login_username.val(); <span style="color:#007f7f">// 获取输入框中的用户名
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">let</span> password = <span style="color:#fff;font-weight:bold">this</span>.$login_password.val(); <span style="color:#007f7f">// 获取输入框中的密码
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">this</span>.$login_error_message.empty(); <span style="color:#007f7f">// 清楚错误信息
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>    $.ajax({
</span></span><span style="display:flex;"><span>        url: <span style="color:#0ff;font-weight:bold">&#34;登录URL&#34;</span>, <span style="color:#007f7f">// 访问url
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        type: <span style="color:#0ff;font-weight:bold">&#34;GET&#34;</span>,
</span></span><span style="display:flex;"><span>        data: {
</span></span><span style="display:flex;"><span>            username: username, <span style="color:#007f7f">// 传输数据
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            password: password,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        success: <span style="color:#fff;font-weight:bold">function</span>(resp){
</span></span><span style="display:flex;"><span>            console.log(resp); <span style="color:#007f7f">// 测试输出
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (resp.result === <span style="color:#0ff;font-weight:bold">&#34;success&#34;</span>) {
</span></span><span style="display:flex;"><span>                location.reload(); <span style="color:#007f7f">// 如果成功就刷新
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>                outer.$login_error_message.html(resp.result); <span style="color:#007f7f">// 如果失败就显示错误信息
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="第三方登录">第三方登录</h2>
<p><a href="https://www.acwing.com/video/3565/">6.2 web端AcWing一键登录-Vedio</a>
在<code>django</code>中集成数据库<code>redis</code>：7m10s~13m20s
<code>redis</code>命令：13m40s~16m34s
<strong>Oauth2一键授权登录的基本原理</strong>：17m30s~29m15s~32m51s
数据表添加<code>openid</code>信息：33m20s~34m47s
<strong>Oauth2一键授权登录的代码实现</strong>：35m20s~1h25s~1h27m20s
用户点击<code>AcWing一键登录</code>，通过<code>urls &amp; views</code>调用<code>apply_code</code>函数，将<code>state</code>放到<code>redis</code>中，将<code>appid &amp; redirect_uri &amp; scope &amp; state</code> 传入<code>apply_code_url</code>链接，返回并重定向至<code>apply_code_url</code>向用户询问是否授权
用户点击<code>同意</code>后，重定向至<code>redirect_uri</code>链接，返回参数为<code>code</code>和<code>state</code>，通过<code>urls &amp; views</code>调用<code>receive_code</code>函数。若验证<code>state</code>失败，直接重定向至初始界面
若验证<code>state</code>成功，将<code>appid &amp; code &amp; secret</code>发送至<code>AcWing服务器</code>，申请授权令牌<code>access_token</code>和用户的<code>openid</code>
若申请令牌成功，将<code>access_token &amp; openid</code>发送至<code>AcWing服务器</code>，得到用户信息，创建并登录用户，最后重定向至初始界面
<a href="https://www.acwing.com/blog/content/12466/">6.2 <strong>Web端AcWing一键登录-讲义</strong></a>
<a href="https://www.acwing.com/solution/content/79354/">6.2 <strong>上课笔记</strong></a>
<code>redirect_uri = quote(&quot;https://app23.acapp.acwing.com.cn/settings/acwing/web/receive_code&quot;)</code></p>
<p><a href="https://www.acwing.com/video/3566/">6.3 acapp端AcWing一键登录-Vedio</a>
<strong>Oauth2一键授权登录的基本原理</strong>：10m~12m20s~16m35s~18m
<strong>Oauth2一键授权登录的代码实现</strong>：19m25s~21m~23m25s~34m29s~42m10s
<a href="https://www.acwing.com/blog/content/12467/">6.3 acapp端AcWing一键登录-讲义</a>
<a href="https://www.acwing.com/solution/content/79365/">6.3 上课笔记</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>账户系统</title>
      <link>https://xancoding.github.io/posts/productive/</link>
      <pubDate>Tue, 11 Oct 2022 07:47:58 +0800</pubDate>
      
      <guid>https://xancoding.github.io/posts/productive/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/activity/content/punch_the_clock/72/&#34;&gt;Django框架课&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;[[SSH]]
[[Docker]]
[[SHELL]]
[[Ngnix&amp;amp;uwsgi]]
[[Redis]]
[[WSS]]
[[Django_channels]]
[[账号系统]]
[[JS简易游戏引擎实现]]
[[JS模块引用]]
&lt;a href=&#34;https://www.acwing.com/solution/content/114359/&#34;&gt;acapp 项目自动化运行&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;项目创建运行&#34;&gt;项目创建&amp;amp;运行&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/solution/content/72577/&#34;&gt;2.1. 创建 django 项目&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;ssh django&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;django-admin startproject acapp&lt;/code&gt;：在当前目录下创建名为&lt;code&gt;acapp&lt;/code&gt;的&lt;code&gt;django&lt;/code&gt;项目&lt;/li&gt;
&lt;li&gt;将项目用&lt;code&gt;git&lt;/code&gt;维护起来
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;ssh-key-gen&lt;/code&gt;：在&lt;code&gt;服务器&lt;/code&gt;中生成密钥（&lt;code&gt;git&lt;/code&gt;通过&lt;code&gt;ssh&lt;/code&gt;传文件）&lt;/li&gt;
&lt;li&gt;在&lt;code&gt;AcGit&lt;/code&gt;中&lt;code&gt;SSH密钥&lt;/code&gt;中添加&lt;code&gt;SSH公钥&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;git init&lt;/code&gt;：创建&lt;code&gt;git&lt;/code&gt;仓库&lt;/li&gt;
&lt;li&gt;在&lt;code&gt;AcGit&lt;/code&gt;上新建空白项目&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
git config --global user.name xxx
git config --global user.email xxx@xxx.com
git add .
git commit -m &amp;#34;xxx&amp;#34;
git remote add origin git@git.acwing.com:xxx/XXX.git #建立连接
git push --set-upstream origin master
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;在本地运行项目： &lt;code&gt;python3 manage.py runserver 0.0.0.0:8000&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;重点：每个 app 里面有这四个东西
&lt;ul&gt;
&lt;li&gt;Models：管理数据库数据&lt;/li&gt;
&lt;li&gt;Views：管理 &lt;code&gt;http&lt;/code&gt; 函数（接收浏览器请求，返回字符串至浏览器）&lt;/li&gt;
&lt;li&gt;Urls：管理路由，即链接与函数的对应关系 (接收链接，调用相对应的函数)&lt;/li&gt;
&lt;li&gt;Templates：存储网页模板管理 &lt;code&gt;html&lt;/code&gt;  文件
&lt;a href=&#34;https://www.acwing.com/solution/content/73097/&#34;&gt;2.1上课笔记&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;菜单界面项目架构设计&#34;&gt;菜单界面&amp;amp;项目架构设计&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/video/3519/&#34;&gt;创建菜单界面-Vedio&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/file_system/file/content/whole/index/content/3199626/&#34;&gt;创建菜单界面-讲义&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/solution/content/73121/&#34;&gt;3.1 上课笔记&lt;/a&gt;
将 &lt;code&gt;src&lt;/code&gt;文件夹下的 &lt;code&gt;JS&lt;/code&gt;源文件打包至 &lt;code&gt;dist&lt;/code&gt; 文件夹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;#! /bin/bash&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;JS_PATH=/home/acs/acapp/game/static/js/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;JS_PATH_DIST=&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;${&lt;/span&gt;JS_PATH&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;}&lt;/span&gt;dist/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;JS_PATH_SRC=&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;${&lt;/span&gt;JS_PATH&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;}&lt;/span&gt;src/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;find $JS_PATH_SRC -type f -name &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;*.js&amp;#39;&lt;/span&gt; | sort | xargs cat &amp;gt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;${&lt;/span&gt;JS_PATH_DIST&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;}&lt;/span&gt;game.js
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;网页渲染流程&lt;/strong&gt;：根据用户的链接，首先进入&lt;code&gt;acapp/urls.py&lt;/code&gt;，根据&lt;code&gt;path&lt;/code&gt;再进入&lt;code&gt;game/urls/index.py&lt;/code&gt;，再根据&lt;code&gt;path&lt;/code&gt;进入下一层&lt;code&gt;url&lt;/code&gt;或调用相对应的&lt;code&gt;views&lt;/code&gt;中的&lt;code&gt;index.py&lt;/code&gt;函数，函数接收参数，在网页端渲染&lt;code&gt;templates/multiends&lt;/code&gt;下的&lt;code&gt;web.html&lt;/code&gt;，&lt;code&gt;html&lt;/code&gt;中有&lt;code&gt;JS&lt;/code&gt;执行
注意：本项目为前后端分离，即通过&lt;code&gt;JS&lt;/code&gt;在&lt;code&gt;client&lt;/code&gt;中渲染项目(动态生成页面)，而不是在&lt;code&gt;server&lt;/code&gt;渲染项目&lt;/p&gt;
&lt;h1 id=&#34;游戏界面&#34;&gt;游戏界面&lt;/h1&gt;
&lt;h3 id=&#34;单人游戏&#34;&gt;单人游戏&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/video/3520/&#34;&gt;4.1 创建游戏界面-Vedio&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/solution/content/79181/&#34;&gt;4.1 上课笔记&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;若修改&lt;code&gt;static文件夹&lt;/code&gt;下的相关文件，需在&lt;code&gt;~/acapp&lt;/code&gt;下执行&lt;code&gt;./scripts/compress_game_js.sh&lt;/code&gt;来打包文件&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;联机对战&#34;&gt;联机对战&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/file_system/file/content/whole/index/content/3357332/&#34;&gt;实现联机对战——讲义&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/video/3581/&#34;&gt;7.1 实现联机对战（上）-Vedio&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/blog/content/12692/&#34;&gt;配置channelsredis&lt;/a&gt;
统一长度单位：7m20s~38m
创建的时候相对于窗口大小创建不同元素适应窗口，画的时候要在这个窗口绝对位置去画
增加“联机对战”模式：40m10s~49m
联机原理：50m~1h2m40s
配置channelsredis：1h2m40s~1h09m11s
&lt;a href=&#34;https://www.acwing.com/solution/content/89506/&#34;&gt;7.1 上课笔记&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/video/3582/&#34;&gt;7.2 实现联机对战（下）-Vedio&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/solution/content/88801/&#34;&gt;7.2 上课笔记&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;调试&#34;&gt;调试&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;~/acapp&lt;/code&gt; 文件夹下执行 &lt;code&gt;python3 manage.py shell&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Def clear ():
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	For key in cache. Keys (&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		Cache. Delete(key)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;&lt;code&gt;from django.core.cache import cache&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;聊天系统&#34;&gt;聊天系统&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/video/3603/&#34;&gt;8.1 聊天功能的实现-Vedio&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/solution/content/89508/&#34;&gt;8.1 上课笔记&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;匹配系统&#34;&gt;匹配系统&lt;/h1&gt;
&lt;p&gt;[[Thrift]]
&lt;a href=&#34;https://www.acwing.com/video/3618/&#34;&gt;9.1 实现匹配系统——thrift服务-Vedio&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/activity/content/code/content/2360556/&#34;&gt;9.1 上课笔记&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;项目收尾&#34;&gt;项目收尾&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://www.acwing.com/file_system/file/content/whole/index/content/3435229/&#34;&gt;讲义&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/video/3619/&#34;&gt;9.2 实现匹配系统——项目收尾-Vedio&lt;/a&gt;
&lt;a href=&#34;https://www.acwing.com/activity/content/code/content/2360556/&#34;&gt;9.2 上课笔记&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;版本更新&#34;&gt;版本更新&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;在&lt;a href=&#34;https://www.acwing.com/user/myspace/application/update/2433/&#34;&gt;术士之战&lt;/a&gt;中将&lt;strong&gt;js地址&lt;/strong&gt;一栏更新为&lt;code&gt;https://app2433.acapp.acwing.com.cn/static/js/dist/game-版本号.js&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;注：文件夹中对应的文件也需要更改名字&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
      <content:encoded><![CDATA[<p><a href="https://www.acwing.com/activity/content/punch_the_clock/72/">Django框架课</a></p>
<hr>
<p>[[SSH]]
[[Docker]]
[[SHELL]]
[[Ngnix&amp;uwsgi]]
[[Redis]]
[[WSS]]
[[Django_channels]]
[[账号系统]]
[[JS简易游戏引擎实现]]
[[JS模块引用]]
<a href="https://www.acwing.com/solution/content/114359/">acapp 项目自动化运行</a></p>
<hr>
<h1 id="项目创建运行">项目创建&amp;运行</h1>
<p><a href="https://www.acwing.com/solution/content/72577/">2.1. 创建 django 项目</a></p>
<ol>
<li><code>ssh django</code></li>
<li><code>django-admin startproject acapp</code>：在当前目录下创建名为<code>acapp</code>的<code>django</code>项目</li>
<li>将项目用<code>git</code>维护起来
<ol>
<li><code>ssh-key-gen</code>：在<code>服务器</code>中生成密钥（<code>git</code>通过<code>ssh</code>传文件）</li>
<li>在<code>AcGit</code>中<code>SSH密钥</code>中添加<code>SSH公钥</code></li>
<li><code>git init</code>：创建<code>git</code>仓库</li>
<li>在<code>AcGit</code>上新建空白项目</li>
</ol>
</li>
</ol>
<pre tabindex="0"><code>
git config --global user.name xxx
git config --global user.email xxx@xxx.com
git add .
git commit -m &#34;xxx&#34;
git remote add origin git@git.acwing.com:xxx/XXX.git #建立连接
git push --set-upstream origin master
</code></pre><ul>
<li>在本地运行项目： <code>python3 manage.py runserver 0.0.0.0:8000</code></li>
<li>重点：每个 app 里面有这四个东西
<ul>
<li>Models：管理数据库数据</li>
<li>Views：管理 <code>http</code> 函数（接收浏览器请求，返回字符串至浏览器）</li>
<li>Urls：管理路由，即链接与函数的对应关系 (接收链接，调用相对应的函数)</li>
<li>Templates：存储网页模板管理 <code>html</code>  文件
<a href="https://www.acwing.com/solution/content/73097/">2.1上课笔记</a></li>
</ul>
</li>
</ul>
<h1 id="菜单界面项目架构设计">菜单界面&amp;项目架构设计</h1>
<p><a href="https://www.acwing.com/video/3519/">创建菜单界面-Vedio</a>
<a href="https://www.acwing.com/file_system/file/content/whole/index/content/3199626/">创建菜单界面-讲义</a>
<a href="https://www.acwing.com/solution/content/73121/">3.1 上课笔记</a>
将 <code>src</code>文件夹下的 <code>JS</code>源文件打包至 <code>dist</code> 文件夹</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#! /bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>JS_PATH=/home/acs/acapp/game/static/js/
</span></span><span style="display:flex;"><span>JS_PATH_DIST=<span style="color:#0ff;font-weight:bold">${</span>JS_PATH<span style="color:#0ff;font-weight:bold">}</span>dist/
</span></span><span style="display:flex;"><span>JS_PATH_SRC=<span style="color:#0ff;font-weight:bold">${</span>JS_PATH<span style="color:#0ff;font-weight:bold">}</span>src/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>find $JS_PATH_SRC -type f -name <span style="color:#0ff;font-weight:bold">&#39;*.js&#39;</span> | sort | xargs cat &gt; <span style="color:#0ff;font-weight:bold">${</span>JS_PATH_DIST<span style="color:#0ff;font-weight:bold">}</span>game.js
</span></span></code></pre></div><p><strong>网页渲染流程</strong>：根据用户的链接，首先进入<code>acapp/urls.py</code>，根据<code>path</code>再进入<code>game/urls/index.py</code>，再根据<code>path</code>进入下一层<code>url</code>或调用相对应的<code>views</code>中的<code>index.py</code>函数，函数接收参数，在网页端渲染<code>templates/multiends</code>下的<code>web.html</code>，<code>html</code>中有<code>JS</code>执行
注意：本项目为前后端分离，即通过<code>JS</code>在<code>client</code>中渲染项目(动态生成页面)，而不是在<code>server</code>渲染项目</p>
<h1 id="游戏界面">游戏界面</h1>
<h3 id="单人游戏">单人游戏</h3>
<p><a href="https://www.acwing.com/video/3520/">4.1 创建游戏界面-Vedio</a>
<a href="https://www.acwing.com/solution/content/79181/">4.1 上课笔记</a></p>
<ul>
<li>若修改<code>static文件夹</code>下的相关文件，需在<code>~/acapp</code>下执行<code>./scripts/compress_game_js.sh</code>来打包文件</li>
</ul>
<h3 id="联机对战">联机对战</h3>
<p><a href="https://www.acwing.com/file_system/file/content/whole/index/content/3357332/">实现联机对战——讲义</a>
<a href="https://www.acwing.com/video/3581/">7.1 实现联机对战（上）-Vedio</a>
<a href="https://www.acwing.com/blog/content/12692/">配置channelsredis</a>
统一长度单位：7m20s~38m
创建的时候相对于窗口大小创建不同元素适应窗口，画的时候要在这个窗口绝对位置去画
增加“联机对战”模式：40m10s~49m
联机原理：50m~1h2m40s
配置channelsredis：1h2m40s~1h09m11s
<a href="https://www.acwing.com/solution/content/89506/">7.1 上课笔记</a>
<a href="https://www.acwing.com/video/3582/">7.2 实现联机对战（下）-Vedio</a>
<a href="https://www.acwing.com/solution/content/88801/">7.2 上课笔记</a></p>
<h4 id="调试">调试</h4>
<ol>
<li><code>~/acapp</code> 文件夹下执行 <code>python3 manage.py shell</code></li>
<li></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Def clear ():
</span></span><span style="display:flex;"><span>	For key in cache. Keys (<span style="color:#0ff;font-weight:bold">&#39;*&#39;</span>):
</span></span><span style="display:flex;"><span>		Cache. Delete(key)
</span></span></code></pre></div><ol start="3">
<li><code>from django.core.cache import cache</code></li>
</ol>
<h1 id="聊天系统">聊天系统</h1>
<p><a href="https://www.acwing.com/video/3603/">8.1 聊天功能的实现-Vedio</a>
<a href="https://www.acwing.com/solution/content/89508/">8.1 上课笔记</a></p>
<h1 id="匹配系统">匹配系统</h1>
<p>[[Thrift]]
<a href="https://www.acwing.com/video/3618/">9.1 实现匹配系统——thrift服务-Vedio</a>
<a href="https://www.acwing.com/activity/content/code/content/2360556/">9.1 上课笔记</a></p>
<h1 id="项目收尾">项目收尾</h1>
<p><a href="https://www.acwing.com/file_system/file/content/whole/index/content/3435229/">讲义</a>
<a href="https://www.acwing.com/video/3619/">9.2 实现匹配系统——项目收尾-Vedio</a>
<a href="https://www.acwing.com/activity/content/code/content/2360556/">9.2 上课笔记</a></p>
<h1 id="版本更新">版本更新</h1>
<ul>
<li>在<a href="https://www.acwing.com/user/myspace/application/update/2433/">术士之战</a>中将<strong>js地址</strong>一栏更新为<code>https://app2433.acapp.acwing.com.cn/static/js/dist/game-版本号.js</code>
<ul>
<li>注：文件夹中对应的文件也需要更改名字</li>
</ul>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title></title>
      <link>https://xancoding.github.io/about/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://xancoding.github.io/about/</guid>
      <description>&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;英文名:&lt;/td&gt;
&lt;td&gt;Xan&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;职业:&lt;/td&gt;
&lt;td&gt;学生&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;运动:&lt;/td&gt;
&lt;td&gt;跑步、徒步&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</description>
      <content:encoded><![CDATA[<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>英文名:</td>
<td>Xan</td>
</tr>
<tr>
<td>职业:</td>
<td>学生</td>
</tr>
<tr>
<td>运动:</td>
<td>跑步、徒步</td>
</tr>
</tbody>
</table>
]]></content:encoded>
    </item>
    
    <item>
      <title></title>
      <link>https://xancoding.github.io/links/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://xancoding.github.io/links/</guid>
      <description>&lt;h1 id=&#34;博客&#34;&gt;博客&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.owenyoung.com/&#34;&gt;Owen 的博客&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://catcoding.me/&#34;&gt;程序员的喵&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.ruanyifeng.com/blog/&#34;&gt;阮一峰的网络日志&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;工具&#34;&gt;工具&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://obsidian.md/&#34;&gt;Obsidian&lt;/a&gt; 知识管理工具&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://hcfy.app/&#34;&gt;划词翻译&lt;/a&gt; 浏览器翻译插件&lt;/li&gt;
&lt;/ul&gt;
</description>
      <content:encoded><![CDATA[<h1 id="博客">博客</h1>
<ul>
<li><a href="https://www.owenyoung.com/">Owen 的博客</a></li>
<li><a href="https://catcoding.me/">程序员的喵</a></li>
<li><a href="https://www.ruanyifeng.com/blog/">阮一峰的网络日志</a></li>
</ul>
<h1 id="工具">工具</h1>
<ul>
<li><a href="https://obsidian.md/">Obsidian</a> 知识管理工具</li>
<li><a href="https://hcfy.app/">划词翻译</a> 浏览器翻译插件</li>
</ul>
]]></content:encoded>
    </item>
    
    
    
  </channel>
</rss>
